<html>
<head>
    <META http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <title>第二十三章. Java 插件 - Chapter&nbsp;23.&nbsp;The Java Plugin</title>
    <link xmlns:xslthl="http://xslthl.sf.net" type="text/css" rel="stylesheet" href="base.css">
    <link xmlns:xslthl="http://xslthl.sf.net" type="text/css" rel="stylesheet" href="docs.css">
    <link xmlns:xslthl="http://xslthl.sf.net" type="text/css" rel="stylesheet" href="userguide.css">
    <meta content="DocBook XSL Stylesheets V1.75.2" name="generator">
    <link rel="home" href="userguide.html" title="Gradle 用户指南">
    <link rel="up" href="userguide.html" title="Gradle 用户指南">
    <link rel="prev" href="standard_plugins.html" title="第二十二章. 标准的 Gradle 插件">
    <link rel="next" href="groovy_plugin.html" title="第二十四章. Groovy 插件"></head>
<body>
    <div class="navheader">
        <div>
            <div class="navbar">
                <a xmlns:xslthl="http://xslthl.sf.net" href="standard_plugins.html" title="第二十二章. 标准的 Gradle 插件">上一章</a>
                <span>|</span>
                <a xmlns:xslthl="http://xslthl.sf.net" href="userguide.html" title="Gradle 用户指南">目录</a>
                <span>|</span>
                <a xmlns:xslthl="http://xslthl.sf.net" href="groovy_plugin.html" title="第二十四章. Groovy 插件">下一章</a>
            </div>
        </div>
    </div>
    <div class="chapter">
        <div class="titlepage">
            <div>
                <div><h1 xmlns:xslthl="http://xslthl.sf.net">
            <a name="java_plugin"></a>第 二十三章. Java 插件</h1>
                    <h3 xmlns:xslthl="http://xslthl.sf.net">
                        <a name="java_plugin"></a>
                        Chapter&nbsp;23.&nbsp;The Java Plugin
                    </h3>
                </div>
            </div>
        </div>
        <p>Java 插件向project 添加了 Java 编译、 测试和捆绑的能力。它是很多其他 Gradle
      插件的基础服务。<br/>
            The Java plugin adds Java compilation, testing and bundling capabilities to a project. It serves as the basis
        for many of the other Gradle plugins.
        </p>
        <div class="section">
            <div class="titlepage">
                <div>
                    <div><h2 class="title">
              <a name="N11E80"></a>23.1. 用法</h2>
                        <h4 class="title">
                            <a name="N11E80"></a>
                            23.1.&nbsp;Usage
                        </h4>
                    </div>
                </div>
            </div>
            <p>要使用 Java 插件，请在构建脚本中加入：<br/>To use the Java plugin, include in your build script:</p>
            <div class="example">
                <a name="useJavaPlugin"></a>
                <p class="title"> <b>示例 23.1. 使用 Java 插件</b><br/><b>Example&nbsp;23.1.&nbsp;Using the Java plugin</b>
                </p>
                <div class="example-contents">
                    <p>
                        <code class="filename">build.gradle</code>
                    </p>
                    <pre class="programlisting">apply plugin: <span xmlns:xslthl="http://xslthl.sf.net" class="hl-string">'java'</span></pre>
                </div>
            </div>
            <br class="example-break"></div>
        <div class="section">
            <div class="titlepage">
                <div>
                    <div><h2 class="title">
              <a name="N11E8F"></a>23.2 源集</h2>
                        <h4 class="title">
                            <a name="N11E8F"></a>
                            23.2.&nbsp;Source sets
                        </h4>
                    </div>
                </div>
            </div>
            <p>Java 插件引入了一个
        <em class="firstterm">源集</em>的概念。一个源集只是一组用于编译并一起执行的源文件。这些源文件可能包括 Java 源代码文件和资源文件。其他有一些插件添加了在源集里包含 Groovy 和 Scala 的源代码文件的能力。一个源集有一个相关联的编译类路径和运行时类路径。<br/>
                The Java plugin introduces the concept of a <em class="firstterm">source set</em>
                . A source set is simply a group of
            source files which are compiled and executed together. These source files may include Java source files and
            resource files. Other plugins add the ability to include Groovy and Scala source files in a source set.
            A source set has an associated compile classpath, and runtime classpath.
            </p>
            <p>源集的一个用途是，把源文件进行逻辑上的分组，以描述它们的目的。例如，你可能会使用一个源集来定义一个集成测试套件，或者你可能会使用单独的源集来定义你的项目的
        API 和实现类。<br/>
                One use for source sets is to group source files into logical groups which describe their purpose. For example,
            you might use a source set to define an integration test suite, or you might use separate source sets to define
            the API and implementation classes of your project.
            </p>
            <p>Java 插件定义了两个标准的源集，分别是
        <code class="literal">main</code>和
        <code class="literal">test</code>。
        <code class="literal">main</code>源集包含你产品的源代码，它们将被编译并组装成一个 JAR 文件。
        <code class="literal">test</code>源集包含你的单元测试的源代码，它们将被编译并使用 JUnit 或
        TestNG来执行。<br/>
                The Java plugin defines two standard source sets, called
                <code class="literal">main</code>
                and
                <code class="literal">test</code>
                .
            The
                <code class="literal">main</code>
                source set contains your production source code, which is compiled and assembled
            into a JAR file. The
                <code class="literal">test</code>
                source set contains your unit test source code, which is
            compiled and executed using JUnit or TestNG.
            </p>
        </div>
        <div class="section">
            <div class="titlepage">
                <div>
                    <div><h2 class="title">
              <a name="N11EA7"></a>23.3. 任务</h2>
                        <h4 class="title">
                            <a name="N11EA7"></a>
                            23.3.&nbsp;Tasks
                        </h4>
                    </div>
                </div>
            </div>
            <p>Java 插件向你的项目添加了大量的任务，如下所示。<br/>
                The Java plugin adds a number of tasks to your project, as shown below.
            </p>
            <div xmlns:xslthl="http://xslthl.sf.net" class="table">
                <p class="title">  <b>表 23.1. Java 插件-任务</b><br/><b>Table&nbsp;23.1.&nbsp;Java plugin - tasks</b>
                </p>
                <div class="table-contents">
                    <table id="N11EAC">
                        <thead>
                            <tr>
                                <td>任务名称<br/>Task name</td>
                                <td>依赖于<br/>Depends on</td>
                                <td>类型<br/>Type</td>
                                <td>描述<br/>Description</td>
                            </tr>
                        </thead>
                        <tr>
                            <td>
                                <code class="literal">compileJava</code>
                            </td>
                            <td>产生编译类路径中的所有任务。这包括了用于
                <code class="literal">编译</code>配置中包含的项目依赖关系的
                <code class="literal">jar</code>任务。<br/>
                                All tasks which produce the compile classpath. This includes the
                                <code class="literal">jar</code>
                                task for
                    project dependencies included in the
                                <code class="literal">compile</code>
                                configuration.
                            </td>
                            <td>
                                <a class="ulink" href="http://gradledoc.qiniudn.com/1.12/dsl/org.gradle.api.tasks.compile.JavaCompile.html" target="_top">
                                    <code class="classname">JavaCompile</code>
                                </a>
                            </td>
                            <td>使用 javac 编译产品中的 Java 源文件。<br/>Compiles production Java source files using javac.</td>
                        </tr>
                        <tr>
                            <td>
                                <code class="literal">processResources</code>
                            </td>
                            <td>-</td>
                            <td>
                                <a class="ulink" href="http://gradledoc.qiniudn.com/1.12/dsl/org.gradle.api.tasks.Copy.html" target="_top">
                                    <code class="classname">Copy</code>
                                </a>
                            </td>
                            <td>把生产资源文件拷贝到生产的类目录中。<br/>
                                Copies production resources into the production classes directory.
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <code class="literal">classes</code>
                            </td>
                            <td><code class="literal">compileJava</code>和
                <code class="literal">processResources</code>。一些插件添加了额外的编译任务。<br/>
                                <code class="literal">compileJava</code>
                                and
                                <code class="literal">processResources</code>
                                .
                    Some plugins add additional compilation tasks.
                            </td>
                            <td>
                                <a class="ulink" href="http://gradledoc.qiniudn.com/1.12/dsl/org.gradle.api.Task.html" target="_top">
                                    <code class="classname">Task</code>
                                </a>
                            </td>
                            <td>组装生产的类目录。<br/>Assembles the production classes directory.</td>
                        </tr>
                        <tr>
                            <td>
                                <code class="literal">compileTestJava</code>
                            </td>
                            <td><code class="literal">compile</code>，再加上所有能产生测试编译类路径的任务。<br/>
                                <code class="literal">compile</code>
                                , plus all tasks which produce the test compile classpath.
                            </td>
                            <td>
                                <a class="ulink" href="http://gradledoc.qiniudn.com/1.12/dsl/org.gradle.api.tasks.compile.JavaCompile.html" target="_top">
                                    <code class="classname">JavaCompile</code>
                                </a>
                            </td>
                            <td>使用 javac 编译 Java 的测试源文件。<br/>Compiles test Java source files using javac.</td>
                        </tr>
                        <tr>
                            <td>
                                <code class="literal">processTestResources</code>
                            </td>
                            <td>-</td>
                            <td>
                                <a class="ulink" href="http://gradledoc.qiniudn.com/1.12/dsl/org.gradle.api.tasks.Copy.html" target="_top">
                                    <code class="classname">Copy</code>
                                </a>
                            </td>
                            <td>把测试的资源文件拷贝到测试的类目录中。<br/>Copies test resources into the test classes directory.</td>
                        </tr>
                        <tr>
                            <td>
                                <code class="literal">testClasses</code>
                            </td>
                            <td><code class="literal">compileTestJava</code>和
                <code class="literal">processTestResources</code>。一些插件添加了额外的测试编译任务。<br/>
                                <code class="literal">compileTestJava</code>
                                and
                                <code class="literal">processTestResources</code>
                                .
                    Some plugins add additional test compilation tasks.
                            </td>
                            <td>
                                <a class="ulink" href="http://gradledoc.qiniudn.com/1.12/dsl/org.gradle.api.Task.html" target="_top">
                                    <code class="classname">Task</code>
                                </a>
                            </td>
                            <td>组装测试的类目录。<br/>Assembles the test classes directory.</td>
                        </tr>
                        <tr>
                            <td>
                                <code class="literal">jar</code>
                            </td>
                            <td>
                                <code class="literal">compile</code>
                            </td>
                            <td>
                                <a class="ulink" href="http://gradledoc.qiniudn.com/1.12/dsl/org.gradle.api.tasks.bundling.Jar.html" target="_top">
                                    <code class="classname">Jar</code>
                                </a>
                            </td>
                            <td>组装 JAR 文件<br/>Assembles the JAR file</td>
                        </tr>
                        <tr>
                            <td>
                                <code class="literal">javadoc</code>
                            </td>
                            <td>
                                <code class="literal">compile</code>
                            </td>
                            <td>
                                <a class="ulink" href="http://gradledoc.qiniudn.com/1.12/dsl/org.gradle.api.tasks.javadoc.Javadoc.html" target="_top">
                                    <code class="classname">Javadoc</code>
                                </a>
                            </td>
                            <td>使用 Javadoc 生成生产的 Java 源代码的API文档<br/>
                                Generates API documentation for the production Java source, using Javadoc
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <code class="literal">test</code>
                            </td>
                            <td><code class="literal">compile</code>， 
                <code class="literal">compileTest</code>，再加上所有产生测试运行时类路径的任务。<br/>
                                <code class="literal">compile</code>
                                ,
                                <code class="literal">compileTest</code>
                                ,
                    plus all tasks which produce the test runtime classpath.
                            </td>
                            <td>
                                <a class="ulink" href="http://gradledoc.qiniudn.com/1.12/dsl/org.gradle.api.tasks.testing.Test.html" target="_top">
                                    <code class="classname">Test</code>
                                </a>
                            </td>
                            <td>使用 JUnit 或 TestNG运行单元测试。<br/>Runs the unit tests using JUnit or TestNG.</td>
                        </tr>
                        <tr>
                            <td>
                                <code class="literal">uploadArchives</code>
                            </td>
                            <td>使用
                <code class="literal">archives</code>的配置生成构件的任务，包括
                <code class="literal">jar</code>。<br/>
                                The tasks which produce the artifacts in the
                                <code class="literal">archives</code>
                                configuration, including
                                <code class="literal">jar</code>
                                .
                            </td>
                            <td>
                                <a class="ulink" href="http://gradledoc.qiniudn.com/1.12/dsl/org.gradle.api.tasks.Upload.html" target="_top">
                                    <code class="classname">Upload</code>
                                </a>
                            </td>
                            <td>使用
                <code class="literal">archives</code>配置上传包括 JAR 文件的构件。<br/>
                                Uploads the artifacts in the
                                <code class="literal">archives</code>
                                configuration, including the JAR file.
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <code class="literal">clean</code>
                            </td>
                            <td>-</td>
                            <td>
                                <a class="ulink" href="http://gradledoc.qiniudn.com/1.12/dsl/org.gradle.api.tasks.Delete.html" target="_top">
                                    <code class="classname">Delete</code>
                                </a>
                            </td>
                            <td>删除项目的build目录。<br/>Deletes the project build directory.</td>
                        </tr>
                        <tr>
                            <td>
                                <code class="literal">clean<em class="replaceable"><code>TaskName</code></em> 
                        </code>
                    </td>
                    <td>-</td>
                    <td>
                        <a class="ulink" href="http://gradledoc.qiniudn.com/1.12/dsl/org.gradle.api.tasks.Delete.html" target="_top">
                            <code class="classname">Delete</code>
                        </a>
                    </td>
                    <td>删除由指定的任务所产生的输出文件。例如， 
                <code class="literal">cleanJar</code>将删除由
                <code class="literal">jar</code>任务中所创建的 JAR 文件，
                <code class="literal">cleanTest</code>将删除由
                <code class="literal">test</code>任务所创建的测试结果。<br/>
                        Deletes the output files produced by the specified task. For example
                        <code class="literal">cleanJar</code>
                        will delete the JAR file created by the
                        <code class="literal">jar</code>
                        task, and
                        <code class="literal">cleanTest</code>
                        will delete the test results created by the
                        <code class="literal">test</code>
                        task.
                    </td>
                </tr>
            </table>
        </div>
    </div>
    <p>对于每个你添加到该项目中的源集，Java 插件将添加以下的编译任务：<br/>
        For each source set you add to the project, the Java plugin adds the following compilation tasks:
    </p>
    <div xmlns:xslthl="http://xslthl.sf.net" class="table">
        <p class="title"><b>表 23.2. Java 插件-源集任务</b><br/>
            <b>Table&nbsp;23.2.&nbsp;Java plugin - source set tasks</b>
        </p>
        <div class="table-contents">
            <table id="java_source_set_tasks">
                <thead>
                    <tr>
                        <td>任务名称<br/>Task name</td>
                        <td>依赖于<br/>Depends on</td>
                        <td>类型<br/>Type</td>
                        <td>描述<br/>Description</td>
                    </tr>
                </thead>
                <tr>
                    <td>
                        <code class="literal">compile<em class="replaceable"><code>SourceSet</code></em> 
                    Java
                </code>
            </td>
            <td>所有产生源集编译类路径的任务。<br/>All tasks which produce the source set's compile classpath.</td>
            <td>
                <a class="ulink" href="http://gradledoc.qiniudn.com/1.12/dsl/org.gradle.api.tasks.compile.JavaCompile.html" target="_top">
                    <code class="classname">JavaCompile</code>
                </a>
            </td>
            <td>使用 javac 编译给定的源集中的 Java 源文件。<br/>
                Compiles the given source set's Java source files using javac.
            </td>
        </tr>
        <tr>
            <td>
                <code class="literal">process<em class="replaceable"><code>SourceSet</code>
            </em>
            Resources
        </code>
    </td>
    <td>-</td>
    <td>
        <a class="ulink" href="http://gradledoc.qiniudn.com/1.12/dsl/org.gradle.api.tasks.Copy.html" target="_top">
            <code class="classname">Copy</code>
        </a>
    </td>
    <td>把给定的源集的资源文件拷贝到类目录中。<br/>
        Copies the given source set's resources into the classes directory.
    </td>
</tr>
<tr>
    <td>
        <code class="literal"><em class="replaceable"><code>sourceSet</code>
    </em>
    Classes
</code>
</td>
<td><code class="literal">compile
                <em class="replaceable">
                  <code>SourceSet</code>
                </em>Java</code> 和 
                <code class="literal">process
                <em class="replaceable">
                  <code>SourceSet</code>
                </em>Resources</code>。某些插件还为源集添加了额外的编译任务。<br/>
<code class="literal">compile<em class="replaceable"><code>SourceSet</code>
</em>
Java
</code>
and
<code class="literal">process<em class="replaceable"><code>SourceSet</code>
</em>
Resources
</code>
.
                    Some plugins add additional compilation tasks for the source set.
</td>
<td><a class="ulink" href="http://gradledoc.qiniudn.com/1.12/dsl/org.gradle.api.Task.html" target="_top">
                    <code class="classname">Task</code>
                  </a>
                </td>
                
<td>组装给定源集的类目录。<br/>Assembles the given source set's classes directory.</td>
</tr>
</table>
</div>
</div>
<p>Java 插件还增加了大量的任务构成该项目的生命周期：<br/>
The Java plugin also adds a number of tasks which form a lifecycle for the project:
</p>
<div xmlns:xslthl="http://xslthl.sf.net" class="table">
<p class="title"><b>表 23.3. Java 插件-生命周期任务</b><br/>
<b>Table&nbsp;23.3.&nbsp;Java plugin - lifecycle tasks</b>
</p>
<div class="table-contents">
<table id="N1204B">
<thead>
<tr>
<td>任务名称<br/>Task name</td>
<td>依赖于<br/>Depends on</td>
<td>类型<br/>Type</td>
<td>描述<br/>Description</td>
</tr>
</thead>
<tr>
<td>
<code class="literal">assemble</code>
</td>
<td>项目中的所有归档项目，包括
                <code class="literal">jar</code>任务。某些插件还向项目添加额外的归档任务。<br/>
All archive tasks in the project, including
<code class="literal">jar</code>
. Some plugins add additional
                    archive tasks to the project.
</td>
<td>
<a class="ulink" href="http://gradledoc.qiniudn.com/1.12/dsl/org.gradle.api.Task.html" target="_top">
<code class="classname">Task</code>
</a>
</td>
<td>组装项目中所有的归类文件。<br/>Assembles all the archives in the project.</td>
</tr>
<tr>
<td>
<code class="literal">check</code>
</td>
<td>项目中的所有核查项目，包括
                <code class="literal">test</code>任务。某些插件还向项目添加额外的核查任务。<br/>
All verification tasks in the project, including
<code class="literal">test</code>
. Some plugins add
                    additional verification tasks to the project.
</td>
<td>
<a class="ulink" href="http://gradledoc.qiniudn.com/1.12/dsl/org.gradle.api.Task.html" target="_top">
<code class="classname">Task</code>
</a>
</td>
<td>执行项目中所有的核查任务。<br/>Performs all verification tasks in the project.</td>
</tr>
<tr>
<td>
<code class="literal">build</code>
</td>
<td><code class="literal">check</code> 和 
                <code class="literal">assemble</code><br/>
<code class="literal">check</code>
and
<code class="literal">assemble</code>
</td>
<td>
<a class="ulink" href="http://gradledoc.qiniudn.com/1.12/dsl/org.gradle.api.Task.html" target="_top">
<code class="classname">Task</code>
</a>
</td>
<td>执行项目的完整构建。<br/>Performs a full build of the project.</td>
</tr>
<tr>
<td>
<code class="literal">buildNeeded</code>
</td>
<td><code class="literal">build</code>任务，以及在
                <code class="literal">testRuntime</code>配置的所有项目库依赖项的
                <code class="literal">build</code>任务。<br/>
<code class="literal">build</code>
and
<code class="literal">build</code>
tasks in all project lib dependencies of the
<code class="literal">testRuntime</code>
configuration.
</td>
<td>
<a class="ulink" href="http://gradledoc.qiniudn.com/1.12/dsl/org.gradle.api.Task.html" target="_top">
<code class="classname">Task</code>
</a>
</td>
<td>执行项目本身及它所依赖的其他所有项目的完整构建。<br/>
Performs a full build of the project and all projects it depends on.
</td>
</tr>
<tr>
<td>
<code class="literal">buildDependents</code>
</td>
<td><code class="literal">build</code>任务，以及在
                <code class="literal">testRuntime</code>配置中对此项目有库依赖的所有项目的
                <code class="literal">build</code>任务。<br/>
<code class="literal">build</code>
and
<code class="literal">build</code>
tasks in all projects with a project lib
                    dependency on this project in a
<code class="literal">testRuntime</code>
configuration.
</td>
<td>
<a class="ulink" href="http://gradledoc.qiniudn.com/1.12/dsl/org.gradle.api.Task.html" target="_top">
<code class="classname">Task</code>
</a>
</td>
<td>执行项目本身及依赖它的其他所有项目的完整构建。<br/>
Performs a full build of the project and all projects which depend on it.
</td>
</tr>
<tr>
<td>
<code class="literal">build<em class="replaceable"><code>ConfigurationName</code>
</em>
</code>
</td>
<td>使用配置
                <em class="replaceable">
                  <code>ConfigurationName</code>
                </em>生成构件的任务。<br/>
The tasks which produce the artifacts in configuration <em class="replaceable"><code>ConfigurationName</code>
</em>
.
</td>
<td>
<a class="ulink" href="http://gradledoc.qiniudn.com/1.12/dsl/org.gradle.api.Task.html" target="_top">
<code class="classname">Task</code>
</a>
</td>
<td>组装指定配置的构件。该任务由Base插件添加，并由Java插件隐式实现。<br/>
Assembles the artifacts in the specified configuration.
                    The task is added by the Base plugin which is implicitly applied by the Java plugin.
</td>
</tr>
<tr>
<td>
<code class="literal">upload<em class="replaceable"><code>ConfigurationName</code>
</em>
</code>
</td>
<td>使用配置
                <em class="replaceable">
                  <code>ConfigurationName</code>
                </em>上传构件的任务。<br/>
The tasks which uploads the artifacts in configuration
<em class="replaceable"><code>ConfigurationName</code>
</em>
.
</td>
<td>
<a class="ulink" href="http://gradledoc.qiniudn.com/1.12/dsl/org.gradle.api.tasks.Upload.html" target="_top">
<code class="classname">Upload</code>
</a>
</td>
<td>组装并上传指定配置的构件。该任务由Base插件添加，并由Java插件隐式实现。<br/>
Assembles and uploads the artifacts in the specified configuration.
                    The task is added by the Base plugin which is implicitly applied by the Java plugin.
</td>
</tr>
</table>
</div>
</div>
<p>下图显示了这些任务之间的关系。<br/>
The following diagram shows the relationships between these tasks.
</p>
<div class="figure">
<a name="N12113"></a>
<p class="title"><b>图23.1. Java插件 ​​- 任务</b><br/>
<b>Figure&nbsp;23.1.&nbsp;Java plugin - tasks</b>
</p>
<div class="figure-contents">
<img src="img/javaPluginTasks.png" alt="Java插件 ​​- 任务"></div>
</div>
<br class="figure-break"></div>
<div class="section">
<div class="titlepage">
<div>
<div><h2 class="title">
              <a name="N12119"></a>23.4. 项目布局</h2>
<h4 class="title">
<a name="N12119"></a>
23.4.&nbsp;Project layout
</h4>
</div>
</div>
</div>
<p>Java
        插件会假定如下所示的项目布局。这些目录都不需要一定存在，或者是里面有什么内容。Java插件将会进行编译，不管它发现什么，并处理缺少的任何东西。<br/>
The Java plugin assumes the project layout shown below. None of these directories need exist or have
            anything in them. The Java plugin will compile whatever it finds, and handles anything which is missing.
</p>
<div xmlns:xslthl="http://xslthl.sf.net" class="table">
<p class="title"><b>表 23.4. Java 插件-默认项目布局</b><br/>
<b>Table&nbsp;23.4.&nbsp;Java plugin - default project layout</b>
</p>
<div class="table-contents">
<table id="javalayout">
<thead>
<tr>
<td>目录<br/>Directory</td>
<td>意义<br/>Meaning</td>
</tr>
</thead>
<tr>
<td>
<code class="filename">src/main/java</code>
</td>
<td>产品的Java源代码<br/>Production Java source</td>
</tr>
<tr>
<td>
<code class="filename">src/main/resources</code>
</td>
<td>产品的资源<br/>Production resources</td>
</tr>
<tr>
<td>
<code class="filename">src/test/java</code>
</td>
<td>Java 测试源代码<br/>Test Java source</td>
</tr>
<tr>
<td>
<code class="filename">src/test/resources</code>
</td>
<td>测试资源<br/>Test resources</td>
</tr>
<tr>
<td>
<code class="filename">src/<em class="replaceable"><code>sourceSet</code>
</em>
/java
</code>
</td>
<td>给定的源集的Java源代码<br/>Java source for the given source set</td>
</tr>
<tr>
<td>
<code class="filename">src/<em class="replaceable"><code>sourceSet</code>
</em>
/resources
</code>
</td>
<td>给定的源集的资源<br/>Resources for the given source set</td>
</tr>
</table>
</div>
</div>
<div class="section">
<div class="titlepage">
<div>
<div> <h3 class="title">
                <a name="N1217C"></a>23.4.1. 更改项目布局</h3>
<h5 class="title">
<a name="N1217C"></a>
23.4.1.&nbsp;Changing the project layout
</h5>
</div>
</div>
</div>
<p>你可以通过配置适当的源集，来配置项目的布局。这一点将在以下各节中详细讨论。这里是如何更改main
          Java 和资源源目录的一个简短的例子。<br/>
You configure the project layout by configuring the appropriate source set. This is discussed in
                more detail in the following sections. Here is a brief example which changes the main Java and resource
                source directories.
</p>
<div class="example">
<a name="customJavaSourceLayout"></a>
<p class="title"><b>示例 23.2. 自定义Java 源代码布局</b><br/>
<b>Example&nbsp;23.2.&nbsp;Custom Java source layout</b>
</p>
<div class="example-contents">
<p>
<code class="filename">build.gradle</code>
</p>
<pre class="programlisting">sourceSets {
    main {
        java {
            srcDir <span xmlns:xslthl="http://xslthl.sf.net" class="hl-string">'src/java'</span>
        }
        resources {
            srcDir <span xmlns:xslthl="http://xslthl.sf.net" class="hl-string">'src/resources'</span>
        }
    }
}</pre>
</div>
</div>
<br class="example-break"></div>
</div>
<div class="section">
<div class="titlepage">
<div>
<div><h2 class="title">
              <a name="sec:java_plugin_and_dependency_management"></a>23.5. 依赖管理</h2>
<h4 class="title">
<a name="sec:java_plugin_and_dependency_management"></a>
23.5.&nbsp;Dependency management
</h4>
</div>
</div>
</div>
<p>Java插件向项目添加了许多依赖配置，如下图所示。它对一些任务指定了这些配置，如
        <code class="literal">compileJava</code>和
        <code class="literal">test</code>。<br/>
The Java plugin adds a number of dependency configurations to your project, as shown below. It assigns
            those configurations to tasks such as
<code class="literal">compileJava</code>
and
<code class="literal">test</code>
.
</p>
<div xmlns:xslthl="http://xslthl.sf.net" class="table">
<p class="title"><b>表23.5. Java插件 ​​- 依赖配置</b><br/>
<b>Table&nbsp;23.5.&nbsp;Java plugin - dependency configurations</b> 
</p>
<div class="table-contents">
<table id="tab:configurations">
<thead>
<tr>
<td>名称<br/>Name</td>
<td>继承自<br/>Extends</td>
<td>在哪些任务中使用<br/>Used by tasks</td>
<td>意义<br/>Meaning</td>
</tr>
</thead>
<tr>
<td>compile</td>
<td>-</td>
<td>compileJava</td>
<td>编译时依赖<br/>Compile time dependencies</td>
</tr>
<tr>
<td>runtime</td>
<td>compile</td>
<td>-</td>
<td>运行时依赖<br/>Runtime dependencies</td>
</tr>
<tr>
<td>testCompile</td>
<td>compile</td>
<td>compileTestJava</td>
<td>用于编译测试的其他依赖<br/>Additional dependencies for compiling tests.</td>
</tr>
<tr>
<td>testRuntime</td>
<td>runtime, testCompile</td>
<td>test</td>
<td>只用于运行测试的其他依赖<br/>Additional dependencies for running tests only.</td>
</tr>
<tr>
<td>archives</td>
<td>-</td>
<td>uploadArchives</td>
<td>由本项目生产的构件（如jar包）。<br/>Artifacts (e.g. jars) produced by this project.</td>
</tr>
<tr>
<td>default</td>
<td>runtime</td>
<td>-</td>
<td>本项目上的默认项目依赖配置。包含本项目运行时所需要的构件和依赖。<br/>
The default configuration used by a project dependency on this project. Contains the artifacts and
                    dependencies required by this project at runtime.
</td>
</tr>
</table>
</div>
</div>
<div class="figure">
<a name="N121FE"></a>
<p class="title"><b>图23.2. Java插件 ​​- 依赖配置</b><br/>
<b>Figure&nbsp;23.2.&nbsp;Java plugin - dependency configurations</b> 
</p>
<div class="figure-contents">
<img src="img/javaPluginConfigurations.png" alt="Java plugin - dependency configurations"></div>
</div>
<br class="figure-break">
<p>对于每个你添加到项目中的源集，Java插件都会添加以下的依赖配置：<br/>
For each source set you add to the project, the Java plugins adds the following dependency configurations:
</p>
<div xmlns:xslthl="http://xslthl.sf.net" class="table">
<p class="title"> <b>表23.6. Java插件 ​​- 源集依赖配置</b><br/>
<b>
Table&nbsp;23.6.&nbsp;Java plugin - source set dependency configurations
</b>
</p>
<div class="table-contents">
<table id="java_source_set_configurations">
<thead>
<tr>
<td>名称<br/>Name</td>
<td>继承自<br/>Extends</td>
<td>在哪些任务中使用<br/>Used by tasks</td>
<td>意义<br/>Meaning</td>
</tr>
</thead>
<tr>
<td>
<em class="replaceable">
<code>sourceSet</code>
</em>
Compile
</td>
<td>-</td>
<td>
compile
<em class="replaceable">
<code>SourceSet</code>
</em>
Java
</td>
<td>给定源集的编译时依赖<br/>Compile time dependencies for the given source set</td>
</tr>
<tr>
<td>
<em class="replaceable">
<code>sourceSet</code>
</em>
Runtime
</td>
<td>
<em class="replaceable">
<code>sourceSet</code>
</em>
Compile
</td>
<td>-</td>
<td>给定源集的运行时依赖<br/>Runtime time dependencies for the given source set</td>
</tr>
</table>
</div>
</div>
</div>
<div class="section">
<div class="titlepage">
<div>
<div> <h2 class="title">
              <a name="N1223E"></a>23.6. 常规属性</h2>
<h4 class="title">
<a name="N1223E"></a>
23.6.&nbsp;Convention properties
</h4>
</div>
</div>
</div>
<p>Java插件向项目添加了许多常规属性，如下图所示。您可以在构建脚本中使用这些属性，就像它们是project对象的属性一样（见
        <a class="xref" href="plugins.html#sub:more_about_convention_objects">第21.3节，“约定”</a>）。<br/>
The Java plugin adds a number of convention properties to the project, shown below. You can use these properties
            in your build script as though they were properties of the project object (see
<a class="xref" href="plugins.html#sub:more_about_convention_objects">Section&nbsp;21.3, &ldquo;Conventions&rdquo;</a>
).
</p>
<div xmlns:xslthl="http://xslthl.sf.net" class="table">
<p class="title"><b>表23.7. Java插件 ​​- 目录属性</b><br/>
<b>Table&nbsp;23.7.&nbsp;Java plugin - directory properties</b>
</p>
<div class="table-contents">
<table id="javaconventionDir">
<thead>
<tr>
<td>属性名称<br/>Property name</td>
<td>类型<br/>Type</td>
<td>默认值<br/>Default value</td>
<td>描述<br/>Description</td>
</tr>
</thead>
<tr>
<td>
<code class="literal">reportsDirName</code>
</td>
<td>
<code class="classname">String</code>
</td>
<td>
<code class="filename">reports</code>
</td>
<td>相对于build目录的目录名称，报告将生成到此目录。<br/>
The name of the directory to generate reports into, relative to the build directory.
</td>
</tr>
<tr>
<td>
<code class="literal">reportsDir</code>
</td>
<td>
<code class="classname">File</code>
(read-only)
</td>
<td>
<code class="filename"><em class="replaceable"><code>buildDir</code>
</em>
/
<em class="replaceable">
<code>reportsDirName</code>
</em>
</code>
</td>
<td>报告将生成到此目录。<br/>The directory to generate reports into.</td>
</tr>
<tr>
<td>
<code class="literal">testResultsDirName</code>
</td>
<td>
<code class="classname">String</code>
</td>
<td>
<code class="literal">test-results</code>
</td>
<td>相对于build目录的目录名称，测试报告的.xml文件将生成到此目录。<br/>
The name of the directory to generate test result .xml files into, relative to the build directory.
</td>
</tr>
<tr>
<td>
<code class="literal">testResultsDir</code>
</td>
<td>
<code class="classname">File</code>
(read-only)
</td>
<td>
<code class="literal"><em class="replaceable"><code>buildDir</code>
</em>
/
<em class="replaceable">
<code>testResultsDirName</code>
</em>
</code>
</td>
<td>测试报告的.xml文件将生成到此目录。<br/>The directory to generate test result .xml files into.</td>
</tr>
<tr>
<td>
<code class="literal">testReportDirName</code>
</td>
<td>
<code class="classname">String</code>
</td>
<td>
<code class="literal">tests</code>
</td>
<td>相对于build目录的目录名称，测试报告将生成到此目录。<br/>
The name of the directory to generate the test report into, relative to the reports directory.
</td>
</tr>
<tr>
<td>
<code class="literal">testReportDir</code>
</td>
<td>
<code class="classname">File</code>
(read-only)
</td>
<td>
<code class="literal"><em class="replaceable"><code>reportsDir</code>
</em>
/
<code class="literal">testReportDirName</code>
</code>
</td>
<td>测试报告生成到此目录。<br/>The directory to generate the test report into.</td>
</tr>
<tr>
<td>
<code class="literal">libsDirName</code>
</td>
<td>
<code class="classname">String</code>
</td>
<td>
<code class="literal">libs</code>
</td>
<td>相对于build目录的目录名称，类库将生成到此目录中。<br/>
The name of the directory to generate libraries into, relative to the build directory.
</td>
</tr>
<tr>
<td>
<code class="literal">libsDir</code>
</td>
<td>
<code class="classname">File</code>
(read-only)
</td>
<td>
<code class="literal"><em class="replaceable"><code>buildDir</code>
</em>
/
<em class="replaceable">
<code>libsDirName</code>
</em>
</code>
</td>
<td>类库将生成到此目录中。<br/>The directory to generate libraries into.</td>
</tr>
<tr>
<td>
<code class="literal">distsDirName</code>
</td>
<td>
<code class="classname">String</code>
</td>
<td>
<code class="literal">distributions</code>
</td>
<td>相对于build目录的目录名称，发布的文件将生成到此目录中。<br/>
The name of the directory to generate distributions into, relative to the build directory.
</td>
</tr>
<tr>
<td>
<code class="literal">distsDir</code>
</td>
<td>
<code class="classname">File</code>
(read-only)
</td>
<td>
<code class="literal"><em class="replaceable"><code>buildDir</code>
</em>
/
<em class="replaceable">
<code>distsDirName</code>
</em>
</code>
</td>
<td>要发布的文件将生成到此目录。<br/>The directory to generate distributions into.</td>
</tr>
<tr>
<td>
<code class="literal">docsDirName</code>
</td>
<td>
<code class="classname">String</code>
</td>
<td>
<code class="literal">docs</code>
</td>
<td>相对于build目录的目录名称，文档将生成到此目录。<br/>
The name of the directory to generate documentation into, relative to the build directory.
</td>
</tr>
<tr>
<td>
<code class="literal">docsDir</code>
</td>
<td>
<code class="classname">File</code>
(read-only)
</td>
<td>
<code class="literal"><em class="replaceable"><code>buildDir</code>
</em>
/
<em class="replaceable">
<code>docsDirName</code>
</em>
</code>
</td>
<td>要生成文档的目录。<br/>The directory to generate documentation into.</td>
</tr>
<tr>
<td>
<code class="literal">dependencyCacheDirName</code>
</td>
<td>
<code class="classname">String</code>
</td>
<td>
<code class="literal">dependency-cache</code>
</td>
<td>相对于build目录的目录名称，该目录用于缓存源代码的依赖信息。<br/>
The name of the directory to use to cache source dependency information, relative to the build directory.
</td>
</tr>
<tr>
<td>
<code class="literal">dependencyCacheDir</code>
</td>
<td>
<code class="classname">File</code>
(read-only)
</td>
<td>
<code class="literal"><em class="replaceable"><code>buildDir</code>
</em>
/
<em class="replaceable">
<code>dependencyCacheDirName</code>
</em>
</code>
</td>
<td>该目录用于缓存源代码的依赖信息。<br/>The directory to use to cache source dependency information.</td>
</tr>
</table>
</div>
</div>
<div xmlns:xslthl="http://xslthl.sf.net" class="table">
<p class="title"> <b>表 23.8. Java 插件 - 其他属性</b><br/>
<b>Table&nbsp;23.8.&nbsp;Java plugin - other properties</b>
</p>
<div class="table-contents">
<table id="javaconventionNonDir">
<thead>
<tr>
<td>属性名称<br/>Property name</td>
<td>类型<br/>Type</td>
<td>默认值<br/>Default value</td>
<td>描述<br/>Description</td>
</tr>
</thead>
<tr>
<td>
<code class="literal">sourceSets</code>
</td>
<td>
<a class="ulink" href="http://gradledoc.qiniudn.com/1.12/javadoc/org/gradle/api/tasks/SourceSetContainer.html" target="_top">
<code class="classname">SourceSetContainer</code>
</a>
(read-only)
</td>
<td>非空<br/>Not null</td>
<td>包含项目的源集。<br/>Contains the project's source sets.</td>
</tr>
<tr>
<td>
<code class="literal">sourceCompatibility</code>
</td>
<td><a class="ulink" href="http://gradledoc.qiniudn.com/1.12/javadoc/org/gradle/api/JavaVersion.html" target="_top">
                  <code class="classname">JavaVersion</code>
                </a>. 可以使用字符串或数字来设置，例如
                <code class="literal">&quot;1.5&quot;</code>或
                <code class="literal">1.5</code>。<br/>
<a class="ulink" href="http://gradledoc.qiniudn.com/1.12/javadoc/org/gradle/api/JavaVersion.html" target="_top">
<code class="classname">JavaVersion</code>
</a>
. Can also set using a String or a Number, e.g.
<code class="literal">'1.5'</code>
or
<code class="literal">1.5</code>
.
</td>
<td>当前JVM所使用的值<br/>Value of the current used JVM</td>
<td>当编译Java源代码时所使用的Java版本兼容性。<br/>
Java version compatibility to use when compiling Java source.
</td>
</tr>
<tr>
<td>
<code class="literal">targetCompatibility</code>
</td>
<td><a class="ulink" href="http://gradledoc.qiniudn.com/1.12/javadoc/org/gradle/api/JavaVersion.html" target="_top">
                  <code class="classname">JavaVersion</code>
                </a>. 可以使用字符串或数字来设置，例如
                <code class="literal">&quot;1.5&quot;</code>或
                <code class="literal">1.5</code>。<br/>
<a class="ulink" href="http://gradledoc.qiniudn.com/1.12/javadoc/org/gradle/api/JavaVersion.html" target="_top">
<code class="classname">JavaVersion</code>
</a>
. Can also set using a String or Number, e.g.
<code class="literal">'1.5'</code>
or
<code class="literal">1.5</code>
.
</td>
<td>
<code class="literal"><em class="replaceable"><code>sourceCompatibility</code>
</em>
</code>
</td>
<td>要生成的类的 Java 版本。<br/>Java version to generate classes for.</td>
</tr>
<tr>
<td>
<code class="literal">archivesBaseName</code>
</td>
<td>
<code class="classname">String</code>
</td>
<td>
<code class="literal"><em class="replaceable"><code>projectName</code>
</em>
</code>
</td>
<td>像JAR或ZIP文件这样的构件的basename<br/>The basename to use for archives, such as JAR or ZIP files.</td>
</tr>
<tr>
<td>
<code class="literal">manifest</code>
</td>
<td>
<a class="ulink" href="http://gradledoc.qiniudn.com/1.12/javadoc/org/gradle/api/java/archives/Manifest.html" target="_top">
<code class="classname">Manifest</code>
</a>
</td>
<td>一个空的清单<br/>an empty manifest</td>
<td>要包括的所有 JAR 文件的清单。<br/>The manifest to include in all JAR files.</td>
</tr>
</table>
</div>
</div>
<p>这些属性由
        <a class="ulink" href="http://gradledoc.qiniudn.com/1.12/dsl/org.gradle.api.plugins.JavaPluginConvention.html" target="_top">
          <code class="classname">JavaPluginConvention</code>
        </a>， 
        <a class="ulink" href="http://gradledoc.qiniudn.com/1.12/dsl/org.gradle.api.plugins.BasePluginConvention.html" target="_top">
          <code class="classname">BasePluginConvention</code>
        </a>和
        <a class="ulink" href="http://gradledoc.qiniudn.com/1.12/dsl/org.gradle.api.plugins.ReportingBasePluginConvention.html" target="_top">
          <code class="classname">ReportingBasePluginConvention</code>
        </a>这些类型的常规对象提供。<br/>
These properties are provided by convention objects of type
<a class="ulink" href="http://gradledoc.qiniudn.com/1.12/dsl/org.gradle.api.plugins.JavaPluginConvention.html" target="_top">
<code class="classname">JavaPluginConvention</code>
</a>
,
<a class="ulink" href="http://gradledoc.qiniudn.com/1.12/dsl/org.gradle.api.plugins.BasePluginConvention.html" target="_top">
<code class="classname">BasePluginConvention</code>
</a>
and
<a class="ulink" href="http://gradledoc.qiniudn.com/1.12/dsl/org.gradle.api.plugins.ReportingBasePluginConvention.html" target="_top">
<code class="classname">ReportingBasePluginConvention</code>
</a>
.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h2 class="title">
              <a name="sec:source_sets"></a>23.7. 使用源集</h2>
<h4 class="title">
<a name="sec:source_sets"></a>
23.7.&nbsp;Working with source sets
</h4>
</div>
</div>
</div>
<p>你可以使用
        <code class="literal">sourceSets</code>属性访问项目的源集。这是项目的源集的容器，它的类型是 
        <a class="ulink" href="http://gradledoc.qiniudn.com/1.12/javadoc/org/gradle/api/tasks/SourceSetContainer.html" target="_top">
          <code class="classname">SourceSetContainer</code>
        </a>。除此之后，还有一个
        <code class="literal">sourceSets
        {}</code>的脚本块，可以传入一个闭包来配置源集容器。源集容器的使用方式几乎与其他容器一样，例如
        <code class="literal">tasks</code>。<br/>
You can access the source sets of a project using the
<code class="literal">sourceSets</code>
property. This
            is a container for the project's source sets, of type
<a class="ulink" href="http://gradledoc.qiniudn.com/1.12/javadoc/org/gradle/api/tasks/SourceSetContainer.html" target="_top">
<code class="classname">SourceSetContainer</code>
</a>
.
            There is also a
<code class="literal">sourceSets { }</code>
script block, which you can pass a closure to configure the
            source set container. The source set container works pretty much the same way as other containers, such
            as
<code class="literal">tasks</code>
.
</p>
<div class="example">
<a name="defineSourceSet"></a>
<p class="title"><b>示例 23.3. 访问源集</b><br/>
<b>Example&nbsp;23.3.&nbsp;Accessing a source set</b>
</p>
<div class="example-contents">
<p>
<code class="filename">build.gradle</code>
</p>
<pre class="programlisting"><span xmlns:xslthl="http://xslthl.sf.net" class="hl-comment">// Various ways to access the main source set</span>
println sourceSets.main.output.classesDir
println sourceSets[<span xmlns:xslthl="http://xslthl.sf.net" class="hl-string">'main'</span>].output.classesDir
sourceSets {
    println main.output.classesDir
}
sourceSets {
    main {
        println output.classesDir
    }
}

<span xmlns:xslthl="http://xslthl.sf.net" class="hl-comment">// Iterate over the source sets</span>
sourceSets.all {
    println name
}</pre>
</div>
</div>
<br class="example-break">
<p>要配置一个现有的源集，你只需使用上面的其中一种访问方法来设置源集的属性。这些属性将在下文中进行介绍。下面是一个配置main 的 Java 和资源目录的例子：<br/>
To configure an existing source set, you simply use one of the above access methods to set the
            properties of the source set. The properties are described below. Here is an example which configures the
            main Java and resources directories:
</p>
<div class="example">
<a name="configureSourceSet"></a>
<p class="title"><b>示例 23.4. 配置源集的源代码目录</b><br/>
<b>
Example&nbsp;23.4.&nbsp;Configuring the source directories of a source set
</b>
</p>
<div class="example-contents">
<p>
<code class="filename">build.gradle</code>
</p>
<pre class="programlisting">sourceSets {
    main {
        java {
            srcDir <span xmlns:xslthl="http://xslthl.sf.net" class="hl-string">'src/java'</span>
        }
        resources {
            srcDir <span xmlns:xslthl="http://xslthl.sf.net" class="hl-string">'src/resources'</span>
        }
    }
}</pre>
</div>
</div>
<br class="example-break">
<div class="section">
<div class="titlepage">
<div>
<div><h3 class="title">
                <a name="N12481"></a>23.7.1. 源集属性</h3>
<h5 class="title">
<a name="N12481"></a>
23.7.1.&nbsp;Source set properties
</h5>
</div>
</div>
</div>
<p>下表列出了一些重要的源集属性。你可以在
          <a class="ulink" href="http://gradledoc.qiniudn.com/1.12/dsl/org.gradle.api.tasks.SourceSet.html" target="_top">
            <code class="classname">SourceSet</code>
          </a>的 API 文档中查看更多的详细信息。<br/>
The following table lists some of the important properties of a source set.
                You can find more details in the API documentation for
<a class="ulink" href="http://gradledoc.qiniudn.com/1.12/dsl/org.gradle.api.tasks.SourceSet.html" target="_top">
<code class="classname">SourceSet</code>
</a>
.
</p>
<div xmlns:xslthl="http://xslthl.sf.net" class="table">
<p class="title"><b>表 23.9. Java 插件 - 源集属性</b><br/>
<b>Table&nbsp;23.9.&nbsp;Java plugin - source set properties</b>
</p>
<div class="table-contents">
<table id="N1248B">
<thead>
<tr>
<td>属性名称<br/>Property name</td>
<td>类型<br/>Type</td>
<td>默认值<br/>Default value</td>
<td>描述<br/>Description</td>
</tr>
</thead>
<tr>
<td>
<code class="literal">name</code>
</td>
<td>
<code class="classname">String</code>
(read-only)
</td>
<td>非空<br/>Not null</td>
<td>用来确定一个源集的源集名称。<br/>The name of the source set, used to identify it.</td>
</tr>
<tr>
<td>
<code class="literal">output</code>
</td>
<td>
<a class="ulink" href="http://gradledoc.qiniudn.com/1.12/dsl/org.gradle.api.tasks.SourceSetOutput.html" target="_top">
<code class="classname">SourceSetOutput</code>
</a>
(read-only)
</td>
<td>非空<br/>Not null</td>
<td>源集的输出文件，包含它编译过的类和资源。<br/>
The output files of the source set, containing its compiled classes and resources.
</td>
</tr>
<tr>
<td>
<code class="literal">output.classesDir</code>
</td>
<td>
<code class="classname">File</code>
</td>
<td>
<code class="literal"><em class="replaceable"><code>buildDir</code>
</em>
/classes/
<em class="replaceable">
<code>name</code>
</em>
</code>
</td>
<td>要生成的该源集的类的目录。<br/>
The directory to generate the classes of this source set into.
</td>
</tr>
<tr>
<td>
<code class="literal">output.resourcesDir</code>
</td>
<td>
<code class="classname">File</code>
</td>
<td>
<code class="literal"><em class="replaceable"><code>buildDir</code>
</em>
/resources/
<em class="replaceable">
<code>name</code>
</em>
</code>
</td>
<td>要生成的该源集的资源的目录。<br/>
The directory to generate the resources of this source set into.
</td>
</tr>
<tr>
<td>
<code class="literal">compileClasspath</code>
</td>
<td>
<a class="ulink" href="http://gradledoc.qiniudn.com/1.12/javadoc/org/gradle/api/file/FileCollection.html" target="_top">
<code class="classname">FileCollection</code>
</a>
</td>
<td><code class="literal">compile
                  <em class="replaceable">
                    <code>SourceSet</code>
                  </em></code> 配置。<br/>
<code class="literal">compile<em class="replaceable"><code>SourceSet</code>
</em>
</code>
configuration.
</td>
<td>该类路径在编译该源集的源文件时使用。<br/>
The classpath to use when compiling the source files of this source set.
</td>
</tr>
<tr>
<td>
<code class="literal">runtimeClasspath</code>
</td>
<td>
<a class="ulink" href="http://gradledoc.qiniudn.com/1.12/javadoc/org/gradle/api/file/FileCollection.html" target="_top">
<code class="classname">FileCollection</code>
</a>
</td>
<td><code class="literal">output</code> + 
                  <code class="literal">runtime
                  <em class="replaceable">
                    <code>SourceSet</code>
                  </em></code> 配置。<br/>
<code class="literal">output</code>
+
<code class="literal">runtime<em class="replaceable"><code>SourceSet</code>
</em>
</code>
configuration.
</td>
<td>该类路径在执行该源集的类时使用。<br/>
The classpath to use when executing the classes of this source set.
</td>
</tr>
<tr>
<td>
<code class="literal">java</code>
</td>
<td>
<a class="ulink" href="http://gradledoc.qiniudn.com/1.12/javadoc/org/gradle/api/file/SourceDirectorySet.html" target="_top">
<code class="classname">SourceDirectorySet</code>
</a>
(read-only)
</td>
<td>非空<br/>Not null</td>
<td>该源集的Java源文件。仅包含Java源文件目录里的
                  <code class="filename">.java</code>文件，并排除其他所有文件。<br/>
The Java source files of this source set. Contains only
<code class="filename">.java</code>
files
                        found in the Java source directories, and excludes all other files.
</td>
</tr>
<tr>
<td>
<code class="literal">java.srcDirs</code>
</td>
<td><code class="classname">Set&lt;File&gt;</code>. 可以使用
                  <a class="xref" href="working_with_files.html#sec:specifying_multiple_files">16.5
                  章节，&quot;指定一组输入文件&quot;</a>中所讲到的任何一个来设置。<br/>
<code class="classname">Set&lt;File&gt;</code>
. Can set using anything described in
<a class="xref" href="working_with_files.html#sec:specifying_multiple_files">
Section&nbsp;16.5, &ldquo;Specifying a set of input files&rdquo;
</a>
.
</td>
<td>
<code class="literal">[<em class="replaceable"><code>projectDir</code>
</em>
/src/
<em class="replaceable">
<code>name</code>
</em>
/java]
</code>
</td>
<td>该源目录包含了此源集的所有Java源文件。<br/>
The source directories containing the Java source files of this source set.
</td>
</tr>
<tr>
<td>
<code class="literal">resources</code>
</td>
<td>
<a class="ulink" href="http://gradledoc.qiniudn.com/1.12/javadoc/org/gradle/api/file/SourceDirectorySet.html" target="_top">
<code class="classname">SourceDirectorySet</code>
</a>
(read-only)
</td>
<td>非空<br/>Not null</td>
<td>此源集的资源文件。仅包含资源文件，并且排除在资源源目录中找到的所有 
                  <code class="filename">.java</code> 文件。其他插件，如Groovy
                  插件，会从该集合中排除其他类型的文件。<br/>
The resources of this source set. Contains only resources, and excludes any
<code class="filename">.java</code>
files found in the resource source directories. Other plugins,
                        such as the Groovy plugin, exclude additional types of files from this collection.
</td>
</tr>
<tr>
<td>
<code class="literal">resources.srcDirs</code>
</td>
<td><code class="classname">Set&lt;File&gt;</code>. 可以使用
                  <a class="xref" href="working_with_files.html#sec:specifying_multiple_files">16.5
                  章节，&quot;指定一组输入文件&quot;</a>中所讲到的任何一个来设置。<br/>
<code class="classname">Set&lt;File&gt;</code>
. Can set using anything described in
<a class="xref" href="working_with_files.html#sec:specifying_multiple_files">
Section&nbsp;16.5, &ldquo;Specifying a set of input files&rdquo;
</a>
.
</td>
<td>
<code class="literal">[<em class="replaceable"><code>projectDir</code>
</em>
/src/
<em class="replaceable">
<code>name</code>
</em>
/resources]
</code>
</td>
<td>该源目录包含了此源集的资源文件。<br/>
The source directories containing the resources of this source set.
</td>
</tr>
<tr>
<td>
<code class="literal">allJava</code>
</td>
<td>
<a class="ulink" href="http://gradledoc.qiniudn.com/1.12/javadoc/org/gradle/api/file/SourceDirectorySet.html" target="_top">
<code class="classname">SourceDirectorySet</code>
</a>
(read-only)
</td>
<td>
<code class="literal">java</code>
</td>
<td>该源集的所有
                  <code class="filename">.java</code> 文件。有些插件，如Groovy
                  插件，会从该集合中增加其他的Java源文件。<br/>
All
<code class="filename">.java</code>
files of this source set. Some plugins, such as the Groovy plugin,
                        add additional Java source files to this collection.
</td>
</tr>
<tr>
<td>
<code class="literal">allSource</code>
</td>
<td>
<a class="ulink" href="http://gradledoc.qiniudn.com/1.12/javadoc/org/gradle/api/file/SourceDirectorySet.html" target="_top">
<code class="classname">SourceDirectorySet</code>
</a>
(read-only)
</td>
<td>
<code class="literal">resources + java</code>
</td>
<td>该源集的所有源文件。包含所有的资源文件和Java源文件。有些插件，如Groovy
                  插件，会从该集合中增加其他的源文件。<br/>
All source files of this source set. This include all resource files and all Java source files.
                        Some plugins, such as the Groovy plugin, add additional source files to this collection.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="section">
<div class="titlepage">
<div>
<div><h3 class="title">
                <a name="N125DD"></a>23.7.2. 定义新的源集</h3>
<h5 class="title">
<a name="N125DD"></a>
23.7.2.&nbsp;Defining new source sets
</h5>
</div>
</div>
</div>
<p>要定义一个新的源集，你只需在
          <code class="literal">sourceSets { }</code>块中引用它。下面是一个示例：<br/>
To define a new source set, you simply reference it in the
<code class="literal">sourceSets { }</code>
block. Here's an example:
</p>
<div class="example">
<a name="defineSourceSet"></a>
<p class="title"><b>示例 23.5. 定义一个源集</b><br/>
<b>Example&nbsp;23.5.&nbsp;Defining a source set</b>
</p>
<div class="example-contents">
<p>
<code class="filename">build.gradle</code>
</p>
<pre class="programlisting">sourceSets {
    intTest
}</pre>
</div>
</div>
<br class="example-break">
<p>当您定义一个新的源集时，Java 插件会为该源集添加一些依赖配置，如
          <a class="xref" href="java_plugin.html#java_source_set_configurations"
          title="表23.6. Java插件 ​​- 源集依赖配置">表 23.6，“Java 插件 -
          源集依赖项配置”</a>所示。你可以使用这些配置来定义源集的编译和运行时的依赖。<br/>
When you define a new source set, the Java plugin adds some dependency configurations for the
                source set, as shown in
<a class="xref" href="java_plugin.html#java_source_set_configurations" title="Table&nbsp;23.6.&nbsp;Java plugin - source set dependency configurations">
Table&nbsp;23.6, &ldquo;Java plugin - source set dependency configurations&rdquo;
</a>
. You can use these configurations to
                define the compile and runtime dependencies of the source set.
</p>
<div class="example">
<a name="sourceSetDependencies"></a>
<p class="title"> <b>示例 23.6. 定义源集依赖</b><br/>
<b>Example&nbsp;23.6.&nbsp;Defining source set dependencies</b>
</p>
<div class="example-contents">
<p>
<code class="filename">build.gradle</code>
</p>
<pre class="programlisting">sourceSets {
    intTest
}

dependencies {
    intTestCompile <span xmlns:xslthl="http://xslthl.sf.net" class="hl-string">'junit:junit:4.11'</span>
    intTestRuntime <span xmlns:xslthl="http://xslthl.sf.net" class="hl-string">'org.ow2.asm:asm-all:4.0'</span>
}</pre>
</div>
</div>
<br class="example-break">
<p>Java 插件还添加了大量的任务，用于组装源集的类，如
          <a class="xref" href="java_plugin.html#java_source_set_tasks" title="表 23.2. Java 插件-源集任务">表
          23.2，“Java 插件 - 源设置任务”</a>所示。例如，对于一个被叫做
          <code class="literal">intTest</code>的源集，你可以运行
          <strong class="userinput">
            <code>gradle intTestClasses</code>
          </strong>来编译 int 测试类。<br/>
The Java plugin also adds a number of tasks which assemble the classes for the
                source set, as shown in
<a class="xref" href="java_plugin.html#java_source_set_tasks" title="Table&nbsp;23.2.&nbsp;Java plugin - source set tasks">
Table&nbsp;23.2, &ldquo;Java plugin - source set tasks&rdquo;
</a>
. For example, for a source set called
<code class="literal">intTest</code>
, you can run <strong class="userinput"><code>gradle intTestClasses</code></strong> 
to compile the
                int test classes.
</p>
<div class="example">
<a name="compileSourceSet"></a>
<p class="title"><b>示例 23.7. 编译源集</b><br/>
<b>Example&nbsp;23.7.&nbsp;Compiling a source set</b>
</p>
<div class="example-contents">
<p><strong class="userinput">
                <code>gradle intTestClasses</code>
              </strong>的输出结果<br/>
Output of <strong class="userinput"><code>gradle intTestClasses</code></strong> 
</p>
<pre class="screen">&gt; gradle intTestClasses
:compileIntTestJava
:processIntTestResources
:intTestClasses

BUILD SUCCESSFUL

Total time: 1 secs</pre>
</div>
</div>
<br class="example-break"></div>
<div class="section">
<div class="titlepage">
<div>
<div><h3 class="title">
                <a name="N12613"></a>23.7.3. 一些源集的范例</h3>
<h5 class="title">
<a name="N12613"></a>
23.7.3.&nbsp;Some source set examples
</h5>
</div>
</div>
</div>
<p>添加一个包含了源集的类的JAR包<br/>Adding a JAR containing the classes of a source set:</p>
<div class="example">
<a name="configureSourceSet"></a>
<p class="title"> <b>示例 23.8. 为一个源集装配一个JAR文件</b><br/>
<b>Example&nbsp;23.8.&nbsp;Assembling a JAR for a source set</b>
</p>
<div class="example-contents">
<p>
<code class="filename">build.gradle</code>
</p>
<pre class="programlisting">task intTestJar(type: Jar) {
    from sourceSets.intTest.output
}</pre>
</div>
</div>
<br class="example-break">
<p>为一个源集生成 Javadoc：<br/>Generating Javadoc for a source set:</p>
<div class="example">
<a name="configureSourceSet"></a>
<p class="title"><b>示例 23.9. 为一个源集生成 Javadoc：</b><br/>
<b>
Example&nbsp;23.9.&nbsp;Generating the Javadoc for a source set
</b>
</p>
<div class="example-contents">
<p>
<code class="filename">build.gradle</code>
</p>
<pre class="programlisting">task intTestJavadoc(type: Javadoc) {
    source sourceSets.intTest.allJava
}</pre>
</div>
</div>
<br class="example-break">
<p>添加一个测试套件以运行一个源集里的测试<br/>Adding a test suite to run the tests in a source set:</p>
<div class="example">
<a name="configureSourceSet"></a>
<p class="title"><b>示例 23.10. 运行源集里的测试</b><br/>
<b>Example&nbsp;23.10.&nbsp;Running tests in a source set</b>
</p>
<div class="example-contents">
<p>
<code class="filename">build.gradle</code>
</p>
<pre class="programlisting">task intTest(type: Test) {
    testClassesDir = sourceSets.intTest.output.classesDir
    classpath = sourceSets.intTest.runtimeClasspath
}</pre>
</div>
</div>
<br class="example-break"></div>
</div>
<div class="section">
<div class="titlepage">
<div>
<div><h2 class="title">
              <a name="sec:javadoc"></a>23.8. Javadoc</h2>
<h4 class="title">
<a name="sec:javadoc"></a>
23.8.&nbsp;Javadoc
</h4>
</div>
</div>
</div>
<p><code class="literal">Javadoc</code>任务是
        <a class="ulink" href="http://gradledoc.qiniudn.com/1.12/dsl/org.gradle.api.tasks.javadoc.Javadoc.html" target="_top">
          <code class="classname">Javadoc</code>
        </a>的一个实例。它支持核心的 javadoc 参数选项，以及在Javadoc可执行文件的
        <a class="ulink" href="http://download.oracle.com/javase/1.5.0/docs/tooldocs/windows/javadoc.html#referenceguide"
        target="_top">参考文档</a>中描述的标准 doclet 参数选项。对于支持的 Javadoc
        参数选项的完整列表，请参考下面的类的 API 文档： 
        <a class="ulink" href="http://gradledoc.qiniudn.com/1.12/javadoc/org/gradle/external/javadoc/CoreJavadocOptions.html" target="_top">
          <code class="classname">CoreJavadocOptions</code>
        </a>和
        <a class="ulink" href="http://gradledoc.qiniudn.com/1.12/javadoc/org/gradle/external/javadoc/StandardJavadocDocletOptions.html" target="_top">
          <code class="classname">StandardJavadocDocletOptions</code>
        </a>。<br/>
The
<code class="literal">javadoc</code>
task is an instance of
<a class="ulink" href="http://gradledoc.qiniudn.com/1.12/dsl/org.gradle.api.tasks.javadoc.Javadoc.html" target="_top">
<code class="classname">Javadoc</code>
</a>
.
            It supports the core javadoc options and the options of the standard doclet described in the
<a class="ulink" href="http://download.oracle.com/javase/1.5.0/docs/tooldocs/windows/javadoc.html#referenceguide" target="_top">reference documentation</a>
of the Javadoc executable.
            For a complete list of supported Javadoc options consult the API documentation of the following classes:
<a class="ulink" href="http://gradledoc.qiniudn.com/1.12/javadoc/org/gradle/external/javadoc/CoreJavadocOptions.html" target="_top">
<code class="classname">CoreJavadocOptions</code>
</a>
and
<a class="ulink" href="http://gradledoc.qiniudn.com/1.12/javadoc/org/gradle/external/javadoc/StandardJavadocDocletOptions.html" target="_top">
<code class="classname">StandardJavadocDocletOptions</code>
</a>
.
</p>
<div xmlns:xslthl="http://xslthl.sf.net" class="table">
<p class="title"><b>表 23.10. Java 插件 - Javadoc 属性</b><br/>
<b>Table&nbsp;23.10.&nbsp;Java plugin - Javadoc properties</b>
</p>
<div class="table-contents">
<table id="N12656">
<thead>
<tr>
<td>任务属性<br/>Task Property</td>
<td>类型<br/>Type</td>
<td>默认值<br/>Default Value</td>
</tr>
</thead>
<tr>
<td>
<code class="literal">classpath</code>
</td>
<td>
<a class="ulink" href="http://gradledoc.qiniudn.com/1.12/javadoc/org/gradle/api/file/FileCollection.html" target="_top">
<code class="classname">FileCollection</code>
</a>
</td>
<td>
<code class="literal">sourceSets.main.output + sourceSets.main.compileClasspath</code>
</td>
</tr>
<tr>
<td>
<code class="literal">source</code>
</td>
<td><a class="ulink" href="http://gradledoc.qiniudn.com/1.12/javadoc/org/gradle/api/file/FileTree.html" target="_top">
                  <code class="classname">FileTree</code>
                </a>. 可以使用
                <a class="xref" href="working_with_files.html#sec:specifying_multiple_files">16.5
                章节，&quot;指定一组输入文件&quot;</a>中所讲到的任何一种方式来设置。<br/>
<a class="ulink" href="http://gradledoc.qiniudn.com/1.12/javadoc/org/gradle/api/file/FileTree.html" target="_top">
<code class="classname">FileTree</code>
</a>
. Can set using anything described in
<a class="xref" href="working_with_files.html#sec:specifying_multiple_files">
Section&nbsp;16.5, &ldquo;Specifying a set of input files&rdquo;
</a>
.
</td>
<td>
<code class="literal">sourceSets.main.allJava</code>
</td>
</tr>
<tr>
<td>
<code class="literal">destinationDir</code>
</td>
<td>
<code class="classname">File</code>
</td>
<td>
<code class="filename"><em class="replaceable"><code>docsDir</code>
</em>
/javadoc
</code>
</td>
</tr>
<tr>
<td>
<code class="literal">title</code>
</td>
<td>
<code class="classname">String</code>
</td>
<td>project的名称和版本<br/>The name and version of the project</td>
</tr>
</table>
</div>
</div>
</div>
<div class="section">
<div class="titlepage">
<div>
<div> <h2 class="title">
              <a name="sec:clean"></a>23.9. 清理</h2>
<h4 class="title">
<a name="sec:clean"></a>
23.9.&nbsp;Clean
</h4>
</div>
</div>
</div>
<p><code class="literal">clean</code> 任务是
        <a class="ulink" href="http://gradledoc.qiniudn.com/1.12/dsl/org.gradle.api.tasks.Delete.html" target="_top">
          <code class="classname">Delete</code>
        </a>的一个实例。它只是删除由其
        <code class="literal">dir</code>属性表示的目录。<br/>
The
<code class="literal">clean</code>
task is an instance of
<a class="ulink" href="http://gradledoc.qiniudn.com/1.12/dsl/org.gradle.api.tasks.Delete.html" target="_top">
<code class="classname">Delete</code>
</a>
. It
            simply removes the directory denoted by its
<code class="literal">dir</code>
property.
</p>
<div xmlns:xslthl="http://xslthl.sf.net" class="table">
<p class="title"><b>表 23.11. Java 插件 - Clean 性能</b><br/>
<b>Table&nbsp;23.11.&nbsp;Java plugin - Clean properties</b>
</p>
<div class="table-contents">
<table id="N126BD">
<thead>
<tr>
<td>任务属性<br/>Task Property</td>
<td>类型<br/>Type</td>
<td>默认值<br/>Default Value</td>
</tr>
</thead>
<tr>
<td>
<code class="literal">dir</code>
</td>
<td>
<code class="classname">File</code>
</td>
<td>
<code class="filename"><em class="replaceable"><code>buildDir</code>
</em>
</code>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
 <h2 class="title">
              <a name="sec:resources"></a>23.10. 资源</h2>
<h4 class="title">
<a name="sec:resources"></a>
23.10.&nbsp;Resources
</h4>
</div>
</div>
</div>
<p>Java 插件使用
        <a class="ulink" href="http://gradledoc.qiniudn.com/1.12/dsl/org.gradle.api.tasks.Copy.html" target="_top">
          <code class="classname">Copy</code>
        </a>任务进行资源的处理。它为该project里的每个源集添加一个实例。你可以在
        <a class="xref"
        href="working_with_files.html#sec:copying_files">16.6章节，“复制文件”</a>中找到关于copy任务的更多信息。<br/>
The Java plugin uses the
<a class="ulink" href="http://gradledoc.qiniudn.com/1.12/dsl/org.gradle.api.tasks.Copy.html" target="_top">
<code class="classname">Copy</code>
</a>
task for resource handling. It adds an
            instance for each source set in the project. You can find out more about the copy task in
<a class="xref" href="working_with_files.html#sec:copying_files">Section&nbsp;16.6, &ldquo;Copying files&rdquo;</a>
.
</p>
<div xmlns:xslthl="http://xslthl.sf.net" class="table">
<p class="title"> <b>表 23.12. Java 插件-ProcessResources 属性</b><br/>
<b>
Table&nbsp;23.12.&nbsp;Java plugin - ProcessResources properties
</b>
</p>
<div class="table-contents">
<table id="N126EB">
<thead>
<tr>
<td>任务属性<br/>Task Property</td>
<td>类型<br/>Type</td>
<td>默认值<br/>Default Value</td>
</tr>
</thead>
<tr>
<td>
<code class="literal">srcDirs</code>
</td>
<td><code class="classname">Object</code>. 可以使用
                <a class="xref" href="working_with_files.html#sec:specifying_multiple_files">16.5
                章节，&quot;指定一组输入文件&quot;</a>中所讲到的任何一个来设置。<br/>
<code class="classname">Object</code>
. Can set using anything described in
<a class="xref" href="working_with_files.html#sec:specifying_multiple_files">
Section&nbsp;16.5, &ldquo;Specifying a set of input files&rdquo;
</a>
.
</td>
<td>
<code class="literal"><em class="replaceable"><code>sourceSet</code>
</em>
.resources
</code>
</td>
</tr>
<tr>
<td>
<code class="literal">destinationDir</code>
</td>
<td><code class="classname">File</code>. 可以使用
                <a class="xref" href="working_with_files.html#sec:locating_files">16.1
                章节，“查找文件”</a>中所讲到的任何一种方式来设置。<br/>
<code class="classname">File</code>
. Can set using anything described in
<a class="xref" href="working_with_files.html#sec:locating_files">Section&nbsp;16.1, &ldquo;Locating files&rdquo;</a>
.
</td>
<td>
<code class="literal"><em class="replaceable"><code>sourceSet</code>
</em>
.output.resourcesDir
</code>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="section">
<div class="titlepage">
<div>
<div><h2 class="title">
              <a name="sec:compile"></a>23.11. CompileJava</h2>
<h4 class="title">
<a name="sec:compile"></a>
23.11.&nbsp;CompileJava
</h4>
</div>
</div>
</div>
<p>Java 插件为该project里的每个源集添加一个
        <a class="ulink" href="http://gradledoc.qiniudn.com/1.12/dsl/org.gradle.api.tasks.compile.JavaCompile.html" target="_top">
          <code class="classname">JavaCompile</code>
        </a>实例。一些最常见的配置选项如下所示。<br/>
The Java plugin adds a
<a class="ulink" href="http://gradledoc.qiniudn.com/1.12/dsl/org.gradle.api.tasks.compile.JavaCompile.html" target="_top">
<code class="classname">JavaCompile</code>
</a>
instance for each
            source set in the project. Some of the most common configuration options are shown below.
</p>
<div xmlns:xslthl="http://xslthl.sf.net" class="table">
<p class="title"><b>表 23.13. Java 插件- Compile属性</b><br/>
<b>Table&nbsp;23.13.&nbsp;Java plugin - Compile properties</b>
</p>
<div class="table-contents">
<table id="N12731">
<thead>
<tr>
<td>任务属性<br/>Task Property</td>
<td>类型<br/>Type</td>
<td>默认值<br/>Default Value</td>
</tr>
</thead>
<tr>
<td>
<code class="literal">classpath</code>
</td>
<td>
<a class="ulink" href="http://gradledoc.qiniudn.com/1.12/javadoc/org/gradle/api/file/FileCollection.html" target="_top">
<code class="classname">FileCollection</code>
</a>
</td>
<td>
<code class="literal"><em class="replaceable"><code>sourceSet</code>
</em>
.compileClasspath
</code>
</td>
</tr>
<tr>
<td>
<code class="literal">source</code>
</td>
<td><a class="ulink" href="http://gradledoc.qiniudn.com/1.12/javadoc/org/gradle/api/file/FileTree.html" target="_top">
                  <code class="classname">FileTree</code>
                </a>. 可以使用
                <a class="xref" href="working_with_files.html#sec:specifying_multiple_files">16.5
                章节，&quot;指定一组输入文件&quot;</a>中所讲到的任何一种方式来设置。<br/>
<a class="ulink" href="http://gradledoc.qiniudn.com/1.12/javadoc/org/gradle/api/file/FileTree.html" target="_top">
<code class="classname">FileTree</code>
</a>
. Can set using anything described in
<a class="xref" href="working_with_files.html#sec:specifying_multiple_files">
Section&nbsp;16.5, &ldquo;Specifying a set of input files&rdquo;
</a>
.
</td>
<td>
<code class="literal"><em class="replaceable"><code>sourceSet</code>
</em>
.java
</code>
</td>
</tr>
<tr>
<td>
<code class="literal">destinationDir</code>
</td>
<td>
<code class="classname">File</code>
.
</td>
<td>
<code class="literal"><em class="replaceable"><code>sourceSet</code>
</em>
.output.classesDir
</code>
</td>
</tr>
</table>
</div>
</div>
<p>compile任务委派了Ant 的 javac 任务。将
        <code class="literal">options.useAnt</code>设置为
        <code class="literal">false</code>将绕过 Ant 任务，而激活 Gradle 的直接编译器集成。在未来的 Gradle
        版本中，将把它作为默认设置。<br/>
The compile task delegates to Ant's javac task. Setting
<code class="literal">options.useAnt</code>
to
<code class="literal">false</code>
activates Gradle's direct compiler integration, bypassing the Ant task. In a future Gradle release, this will become the default.
</p>
<p>默认情况下，Java 编译器在 Gradle 过程中运行。将
        <code class="literal">options.fork</code>设置为
        <code class="literal">true</code>将会使编译出现在一个单独的进程中。在 Ant javac
        任务中，这意味着将会为每一个compile任务fork一个新的进程，而这将会使编译变慢。相反，Gradle
        的直接编译器集成 （见上文） 将尽可能多地重用相同的编译器进程。在这两种情况下，使用
        <code class="literal">options.forkOptions</code>指定的所有fork选项都将得到重视。<br/>
By default, the Java compiler runs in the Gradle process. Setting
<code class="literal">options.fork</code>
to
<code class="literal">true</code>
causes compilation to occur in a separate process. In the case of the Ant javac task, this means that a new process will be
            forked for each compile task, which can slow down compilation. Conversely, Gradle's direct compiler integration (see above) will
            reuse the same compiler process as much as possible. In both cases, all fork options specified
            with
<code class="literal">options.forkOptions</code>
will be honored.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div><h2 class="title">
              <a name="sec:java_test"></a>23.12. Test</h2>
<h4 class="title">
<a name="sec:java_test"></a>
23.12.&nbsp;Test
</h4>
</div>
</div>
</div>
<p><code class="literal">test</code>任务是
        <a class="ulink" href="http://gradledoc.qiniudn.com/1.12/dsl/org.gradle.api.tasks.testing.Test.html" target="_top">
          <code class="classname">Test</code>
        </a>的一个实例。它会自动检测和执行
        <code class="literal">test</code>源集中的所有单元测试。测试执行完成后，它还会生成一份报告。同时支持
        JUnit 和 TestNG。可以看一看
        <a class="ulink" href="http://gradledoc.qiniudn.com/1.12/dsl/org.gradle.api.tasks.testing.Test.html" target="_top">
          <code class="classname">Test</code>
        </a>的完整的 API。<br/>
The
<code class="literal">test</code>
task is an instance of
<a class="ulink" href="http://gradledoc.qiniudn.com/1.12/dsl/org.gradle.api.tasks.testing.Test.html" target="_top">
<code class="classname">Test</code>
</a>
.
            It automatically detects and executes all unit tests in the
<code class="literal">test</code>
source set.
            It also generates a report once test execution is complete. JUnit and TestNG are both supported.
            Have a look at
<a class="ulink" href="http://gradledoc.qiniudn.com/1.12/dsl/org.gradle.api.tasks.testing.Test.html" target="_top">
<code class="classname">Test</code>
</a>
for the complete API.
</p>
<div class="section">
<div class="titlepage">
<div>
<div><h3 class="title">
                <a name="N127A8"></a>23.12.1. 测试执行</h3>
<h5 class="title">
<a name="N127A8"></a>
23.12.1.&nbsp;Test execution
</h5>
</div>
</div>
</div>
<p>测试在单独的 JVM中执行，与main构建进程隔离。
          <a class="ulink" href="http://gradledoc.qiniudn.com/1.12/dsl/org.gradle.api.tasks.testing.Test.html" target="_top">
            <code class="classname">Test</code>
          </a>任务的 API 可以让你控制什么时候开始。<br/>
Tests are executed in a separate JVM, isolated from the main build process. The
<a class="ulink" href="http://gradledoc.qiniudn.com/1.12/dsl/org.gradle.api.tasks.testing.Test.html" target="_top">
<code class="classname">Test</code>
</a>
task's
                API allows you some control over how this happens.
</p>
<p>有大量的属性用于控制测试进程的启动。这包括系统属性、 JVM 参数和使用的 Java 可执行文件。<br/>
There are a number of properties which control how the test process is launched. This includes
                things such as system properties, JVM arguments, and the Java executable to use.
</p>
<p>你可以指定是否要并行运行你的测试。Gradle
          通过同时运行多个测试进程来提供并行测试的执行。每个测试进程会依次执行一个单一的测试，所以你一般不需要对你的测试做任何的配置来利用这一点。
          <code class="literal">maxParallelForks</code>属性指定在给定的时间可以运行的测试进程的最大数。它的默认值是
          1，也就是说，不并行执行测试。<br/>
You can specify whether or not to execute your tests in parallel. Gradle provides parallel test execution
                by running multiple test processes concurrently. Each test process executes only a single test at a time, so you
                generally don't need to do anything special to your tests to take advantage of this.
                The
<code class="literal">maxParallelForks</code>
property specifies the maximum number of test processes to run
                at any given time. The default is 1, that is, do not execute the tests in parallel.
</p>
<p>测试进程程会为其将
          <code class="literal">org.gradle.test.worker</code>系统属性设置为一个唯一标识符，这个标识符可以用于文件名称或其他资源标识符。<br/>
The test process sets the
<code class="literal">org.gradle.test.worker</code>
system property to a unique
                identifier for that test process, which you can use, for example, in files names or other
                resource identifiers.
</p>
<p>你可以指定在执行了一定数量的测试类之后，重启那个测试进程。这是一个很有用的替代方案，让你的测试进程可以有很大的堆内存。
          <code class="literal">forkEvery</code>属性指定了要在测试进程中执行的测试类的最大数。默认是每个测试进程中执行的测试数量不限。<br/>
You can specify that test processes should be restarted after it has executed a certain number of
                test classes. This can be a useful alternative to giving your test process a very large
                heap.
                The
<code class="literal">forkEvery</code>
property specifies the
                maximum number of test classes to execute in a test process. The default is to execute an unlimited number
                of tests in each test process.
</p>
<p>该任务有一个
          <code class="literal">ignoreFailures</code>属性，用以控制测试失败时的行为。test
          会始终执行它检测到的每一个测试。如果
          <code class="literal">ignoreFailures</code>为 false，并且有测试不通过，那它会停止继续构建。
          <code class="literal">IgnoreFailures</code>的默认值为 false。<br/>
The task has an
<code class="literal">ignoreFailures</code>
property to control the behavior when tests fail.
                Test always executes every test that it detects. It stops the build afterwards if
<code class="literal">ignoreFailures</code>
is false and there are failing tests. The default value of
<code class="literal">ignoreFailures</code>
is false.
</p>
<p><code class="literal">testLogging</code>属性可以配置哪些测试事件需要记录，并且使用什么样的日志级别。默认情况下，对于每个失败的测试都只会打印一个简洁的消息。请参阅
          <a class="ulink" href="http://gradledoc.qiniudn.com/1.12/dsl/org.gradle.api.tasks.testing.logging.TestLoggingContainer.html" target="_top">
            <code class="classname">TestLoggingContainer</code>
          </a>，查看如何把你的测试日志打印调整为你的偏好设置。<br/>
The
<code class="literal">testLogging</code>
property allows to configure which test events are going to be logged and at
                which detail level. By default, a concise message will be logged for every failed test. See
<a class="ulink" href="http://gradledoc.qiniudn.com/1.12/dsl/org.gradle.api.tasks.testing.logging.TestLoggingContainer.html" target="_top">
<code class="classname">TestLoggingContainer</code>
</a>
for how to tune test logging to your
                preferences.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div><h3 class="title">
                <a name="N127D8"></a>23.12.2. 调试</h3>
<h5 class="title">
<a name="N127D8"></a>
23.12.2.&nbsp;Debugging
</h5>
</div>
</div>
</div>
<p>test任务提供了一个
          <a class="ulink" href="http://gradledoc.qiniudn.com/1.12/dsl/org.gradle.api.tasks.testing.Test.html#org.gradle.api.tasks.testing.Test:debug"
          target="_top">
            <code class="classname">Test.getDebug()</code>
          </a>属性，可以设置为启动，使JVM在执行测试之前，等待一个debugger连接到它的5005端口上。<br/>
The test task provides a
<a class="ulink" href="http://gradledoc.qiniudn.com/1.12/dsl/org.gradle.api.tasks.testing.Test.html#org.gradle.api.tasks.testing.Test:debug" target="_top">
<code class="classname">Test.getDebug()</code>
</a>
property that can be set to launch to make the JVM wait for a
                debugger to attach to port 5005 before proceeding with test execution.
</p>
<p>这也可以在调用时通过
          <strong class="userinput">
            <code>--debug-vm</code>
          </strong> task 选项进行启用。<br/>
This can also be enabled at invocation time via the
<strong class="userinput">
<code>--debug-jvm</code>
</strong>
task option.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div><h3 class="title">
                <a name="test_filtering"></a>23.12.3. 测试过滤</h3>
<h5 class="title">
<a name="test_filtering"></a>
23.12.3.&nbsp;Test filtering
</h5>
</div>
</div>
</div>
<p>从Gradle 1.10
          开始，可以根据测试的名称模式，只包含指定的测试。过滤，相对于测试类的包含或排除，是一个不同的机制。它将在接下来的段落中进行描述（
          <code class="literal">-Dtest.single</code>， 
          <code class="literal">test.include</code>和friends）。后者基于文件，比如测试实现类的物理位置。file-level
          的测试选择不支持的很多有趣的情况，都可以用 test-level
          过滤来做到。以下这些场景中，有一些Gradle现在就可以处理，而有一些则将在未来得到实现：<br/>
Starting with Gradle 1.10, it is possible to include only specific tests, based on the test name pattern.
                Filtering is a different mechanism than test class inclusion / exclusion that will be described in the next few paragraphs
                (
<code class="literal">-Dtest.single</code>
,
<code class="literal">test.include</code>
and friends).
                The latter is based on files, e.g. the physical location of the test implementation class.
                File-level test selection does not support many interesting scenarios that are possible with test-level filtering.
                Some of them Gradle handles now and some will be satisfied in the future releases:
</p>
<div class="itemizedlist">
<ul class="itemizedlist">
<li class="listitem">在指定的测试的方法级别上进行过滤；执行单个测试方法<br/>
Filtering at the level of specific test methods; executing a single test method
</li>
<li class="listitem">基于自定义注解（以后实现）进行过滤<br/>Filtering based on custom annotations (future)</li>
<li class="listitem">基于测试层次结构进行过滤；执行所有继承了某一基类（以后实现）的测试<br/>
Filtering based on test hierarchy; executing all tests that extend ceratain base class (future)
</li>
<li class="listitem">基于一些自定义的运行时的规则进行过滤，例如某个系统属性或一些静态的特定值（以后实现）<br/>
Filtering based on some custom runtime rule, e.g. particular value of a system property or some static state (future)
</li>
</ul>
</div>
<p></p>
<p>测试过滤功能具有以下的特征：<br/>Test filtering feature has following characteristic:</p>
<div class="itemizedlist">
<ul class="itemizedlist">
<li class="listitem">支持完整的限定类名称或完整的限定的方法名称，例如“org.gradle.SomeTest”、“org.gradle.SomeTest.someMethod”<br/>
Fully qualified class name or fully qualified method name is supported,
                        e.g. "org.gradle.SomeTest", "org.gradle.SomeTest.someMethod"
</li>
<li class="listitem">通配符 “*” 支付匹配任何字符<br/>Wildcard '*' is supported for matching any characters</li>
<li class="listitem">提供了“--tests”的命令行选项，以方便地设置测试过滤器。这对“单一测试方法的执行”的经典用例特别有用。当使用该命令行选项选项时，在构建脚本中声明的列入过滤器的测试将会被忽略。<br/>
Command line option "--tests" is provided to conveniently set the test filter.
                        Especially useful for the classic 'single test method execution' use case.
                        When the command line option is used, the inclusion filters declared in the build script are ignored.
</li>
<li class="listitem">Gradle 尽最大努力对有着特定的测试框架 API
              的局限的测试进行过滤。一些高级的、
              综合的测试可能不完全符合过滤条件。然而，绝大多数的测试和用例都会被很好地处理。<br/>
Gradle tries best to filter the tests given limitations of particular test framework API.
                        Some advanced, synthetic tests may not be fully compatible with filtering.
                        However, vast majority of tests and use cases should be handled neatly.
</li>
<li class="listitem">测试过滤将会取代基于文件的测试选择。后者可能在将来会被完全地取代掉。我们将会继续改进测试过滤的API，并添加更多种类的过滤器。<br/>
Test filtering supersedes the file-based test selection. The latter may be completely replaced in future.
                        We will grow the the test filtering api and add more kinds of filters.
</li>
</ul>
</div>
<p></p>
<p></p>
<div class="example">
<a name="testfiltering"></a>
<p class="title"><b>示例 23.11. 在构建脚本中过滤测试</b><br/>
<b>Example&nbsp;23.11.&nbsp;Filtering tests in the build script</b>
</p>
<div class="example-contents">
<p>
<code class="filename">build.gradle</code>
</p>
<pre class="programlisting">test {
    filter {
        <span xmlns:xslthl="http://xslthl.sf.net" class="hl-comment">//include specific method in any of the tests</span>
        includeTestsMatching <span xmlns:xslthl="http://xslthl.sf.net" class="hl-string">"*UiCheck"</span>

        <span xmlns:xslthl="http://xslthl.sf.net" class="hl-comment">//include all tests from package</span>
        includeTestsMatching <span xmlns:xslthl="http://xslthl.sf.net" class="hl-string">"org.gradle.internal.*"</span>

        <span xmlns:xslthl="http://xslthl.sf.net" class="hl-comment">//include all integration tests</span>
        includeTestsMatching <span xmlns:xslthl="http://xslthl.sf.net" class="hl-string">"*IntegTest"</span>
    }
}</pre>
</div>
</div>
<p>
<br class="example-break"><br class="example-break" />有关更多的详细信息和示例，请参阅
          <a class="ulink" href="http://gradledoc.qiniudn.com/1.12/javadoc/org/gradle/api/tasks/testing/TestFilter.html" target="_top">
            <code class="classname">TestFilter</code>
          </a>的文档。<br/>
For more details and examples please see the
<a class="ulink" href="http://gradledoc.qiniudn.com/1.12/javadoc/org/gradle/api/tasks/testing/TestFilter.html" target="_top">
<code class="classname">TestFilter</code>
</a>
reference.
</p>
<p>使用命令行选项的一些示例：<br/>Some examples of using the command line option:</p>
<div class="itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p>
<code class="literal">gradle test --tests org.gradle.SomeTest.someSpecificFeature</code>
</p>
</li>
<li class="listitem">
<p>
<code class="literal">gradle test --tests *SomeTest.someSpecificFeature</code>
</p>
</li>
<li class="listitem">
<p>
<code class="literal">gradle test --tests *SomeSpecificTest</code>
</p>
</li>
<li class="listitem">
<p>
<code class="literal">gradle test --tests all.in.specific.package*</code>
</p>
</li>
<li class="listitem">
<p>
<code class="literal">gradle test --tests *IntegTest</code>
</p>
</li>
<li class="listitem">
<p>
<code class="literal">gradle test --tests *IntegTest*ui*</code>
</p>
</li>
<li class="listitem">
<p>
<code class="literal">gradle someTestTask --tests *UiTest someOtherTestTask --tests *WebTest*ui</code>
</p>
</li>
</ul>
</div>
<p></p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div><h3 class="title">
                <a name="N1283D"></a>23.12.4. 通过系统属性执行单一的测试</h3>
<h5 class="title">
<a name="N1283D"></a>
23.12.4.&nbsp;Single test execution via System Properties
</h5>
</div>
</div>
</div>
<div class="note">这种机制已经被上述的“测试过滤”所取代。<br/>
This mechanism has been superseded by 'Test Filtering', described above.
</div>
<p>设置一个 
          <em class="replaceable">
            <code>taskName.single</code>
          </em> = 
          <em class="replaceable">
            <code>testNamePattern</code>
          </em> 的系统属性将会只执行匹配 
          <em class="replaceable">
            <code>testNamePattern</code>
          </em>的那些测试。这个
          <em class="replaceable">
            <code>taskName</code>
          </em> 可以是一个完整的多项目路径，比如“sub1:sub2:test”，或者仅是一个任务名称。
          <em class="replaceable">
            <code>testNamePattern</code>
          </em>将用于形成一个“**/testNamePattern*.class”的包含模式。如果这个模式无法找到任何测试，那么将会抛出一个异常。这是为了使你不会误以为测试通过。如果执行了一个以上的子项目的测试，该模式会被应用于每一个子项目中。如果在一个特定的子项目中，找不到测试用例，那么将会抛出异常。在这种情况下你可以使用路径标记法的模式，这样该模式就会只应用于特定的子项目的测试任务中。或者你可以指定要执行的任务的完整限定名称。你还可以指定多个模式。示例：<br/>
Setting a system property of
<em class="replaceable">
<code>taskName.single</code>
</em>
=
<em class="replaceable">
<code>testNamePattern</code>
</em>
will only execute tests that match the specified
<em class="replaceable">
<code>testNamePattern</code>
</em>
.
                  The
<em class="replaceable">
<code>taskName</code>
</em>
can be a full multi-project path like ":sub1:sub2:test"
                  or just the task name.  The
<em class="replaceable">
<code>testNamePattern</code>
</em>
will be used to form an include
                  pattern of "**/testNamePattern*.class".
                  If no tests with this pattern can be found an exception is thrown. This is to shield you from false security.
                  If tests of more than one subproject are executed, the pattern is applied to each subproject. An exception
                  is thrown if no tests can be found for a particular subproject. In such a case you can use the path notation of the
                  pattern, so that the pattern is applied only to the test task of a specific subproject. Alternatively you can specify the fully
                  qualified task name to be executed. You can also specify multiple patterns. Examples:
</p>
<div class="itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p>
<code class="literal">gradle -Dtest.single=ThisUniquelyNamedTest test</code>
</p>
</li>
<li class="listitem">
<p>
<code class="literal">gradle -Dtest.single=a/b/ test</code>
</p>
</li>
<li class="listitem">
<p>
<code class="literal">gradle -DintegTest.single=*IntegrationTest integTest</code>
</p>
</li>
<li class="listitem">
<p>
<code class="literal">gradle -Dtest.single=:proj1:test:Customer build</code>
</p>
</li>
<li class="listitem">
<p>
<code class="literal">gradle -DintegTest.single=c/d/ :proj1:integTest</code>
</p>
</li>
</ul>
</div>
<p></p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div><h3 class="title">
                <a name="N12869"></a>23.12.5. 测试检测</h3>
<h5 class="title">
<a name="N12869"></a>
23.12.5.&nbsp;Test detection
</h5>
</div>
</div>
</div>
<p><code class="literal">Test</code>任务通过检查编译过的测试类来检测哪些类是测试类。默认情况下它会扫描所有的
          <code class="filename">.class</code>文件。您可以设置自定义的includes 或
          excludes，这样就只有这些类才会被扫描。根据所使用的测试框架 （JUnit 或
          TestNG），会使用不同的标准进行测试类的检测。<br/>
The
<code class="literal">Test</code>
task detects which classes are test classes by inspecting the compiled test classes.
                By default it scans all
<code class="filename">.class</code>
files. You can set custom includes / excludes, only those
                classes will be scanned. Depending on the test framework used (JUnit / TestNG) the test class detection
                uses different criteria.
</p>
<p>当使用 JUnit 时，我们扫描 JUnit 3 和 4
          的测试类。如果满足以下的任何一个条件，这个类就被认为是一个 JUnit 测试类：<br/>
When using JUnit, we scan for both JUnit 3 and 4 test classes. If any of the following criteria match, the
                class is considered to be a JUnit test class:
</p>
<div class="itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p>类或超类继承自
                <code class="classname">TestCase</code>或
                <code class="classname">GroovyTestCase</code><br/>
Class or a super class extends
<code class="classname">TestCase</code>
or
<code class="classname">GroovyTestCase</code>
</p>
</li>
<li class="listitem">
<p>类或超类使用了 <code class="classname">@RunWith</code>进行注解<br/>
Class or a super class is annotated with
<code class="classname">@RunWith</code>
</p>
</li>
<li class="listitem">
<p>类或超类含有一个带 <code class="classname">@Test</code> 注解的方法<br/>
Class or a super class contain a method annotated with
<code class="classname">@Test</code>
</p>
</li>
</ul>
</div>
<p></p>
<p>当使用 TestNG 时，我们扫描所有带有 <code class="classname">@Test</code>注解的方法。<br/>
When using TestNG, we scan for methods annotated with
<code class="classname">@Test</code>
.
</p>
<p>请注意，抽象类不会被执行。Gradle 还将扫描测试类路径中的 jar 文件里的继承树。<br/>
Note that abstract classes are not executed. Gradle also scan up the inheritance tree into jar files
                on the test classpath.
</p>
<p>如果你不想要使用测试类检测，可以通过设置
          <code class="literal">scanForTestClasses</code>为 false 来禁用它。这将使test任务只使用includes / excludes
          来找到测试类。如果
          <code class="literal">scanForTestClasses</code>为disabled，并且没有指定
          include或exclude模式，则使用各自的默认值。对于 include 的默认值是 
          <code class="literal">&quot;**/*Tests.class&quot;，
          &quot;**/*Test.class&quot;</code>，而对于exclude它的默认值是 
          <code class="literal">&quot;**/Abstract*.class&quot;</code>。<br/>
In case you don't want to use the test class detection, you can disable it by setting
<code class="literal">scanForTestClasses</code>
to false. This will make the test task only use the includes /
                excludes to find test classes.

                If
<code class="literal">scanForTestClasses</code>
is disabled and no include or exclude patterns are specified, the
                respective defaults are used. For include this is
<code class="literal">"**/*Tests.class", "**/*Test.class"</code>
and the for exclude it is
<code class="literal">"**/Abstract*.class"</code>
.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div><h3 class="title">
                <a name="test_grouping"></a>23.12.6. 测试分组</h3>
<h5 class="title">
<a name="test_grouping"></a>
23.12.6.&nbsp;Test grouping
</h5>
</div>
</div>
</div>
<p>JUnit 和 TestNG 可以对测试方法进行复杂的分组。<br/>
JUnit and TestNG allows sophisticated groupings of test methods.
</p>
<p>为对Junit 测试类和方法进行分组，JUnit 4.8引入了类别的概念。
          <sup>[
          <a href="java_plugin.html#ftn.N128A7" name="N128A7" class="footnote">9</a>]</sup> 
          <code class="literal">test</code>任务可以实现一个规范，让你include和exclude 想要的 JUnit 类别。<br/>
For grouping JUnit test classes and methods JUnit 4.8 introduces the concept of categories. <sup>[
<a href="java_plugin.html#ftn.N128A7" name="N128A7" class="footnote">9</a>
]</sup> 
The
<code class="literal">test</code>
task allows the specification of the JUnit categories you want to include and exclude.
</p>
<div class="example">
<a name="junitcategories"></a>
<p class="title"><b>示例 23.12. JUnit 类别</b><br/>
<b>Example&nbsp;23.12.&nbsp;JUnit Categories</b>
</p>
<div class="example-contents">
<p>
<code class="filename">build.gradle</code>
</p>
<pre class="programlisting">test {
    useJUnit {
        includeCategories <span xmlns:xslthl="http://xslthl.sf.net" class="hl-string">'org.gradle.junit.CategoryA'</span>
        excludeCategories <span xmlns:xslthl="http://xslthl.sf.net" class="hl-string">'org.gradle.junit.CategoryB'</span>
    }
}</pre>
</div>
</div>
<br class="example-break">
<p>TestNG 框架有一个非常相似的概念。在 TestNG 中你可以指定不同的测试组。
          <sup>[
          <a href="java_plugin.html#ftn.N128BD" name="N128BD"
          class="footnote">10</a>]</sup>应从测试执行中include或exclude的测试组，可以在test任务中配置。<br/>
The TestNG framework has a quite similar concept. In TestNG you can specify different test groups. <sup>[
<a href="java_plugin.html#ftn.N128BD" name="N128BD" class="footnote">10</a>
]</sup> 
The test groups that should be included or excluded from the test execution can be configured in the test task.
</p>
<div class="example">
<a name="testnggrouping"></a>
<p class="title"> <b>示例 23.13. 对TestNG 测试分组</b><br/>
<b>Example&nbsp;23.13.&nbsp;Grouping TestNG tests</b>
</p>
<div class="example-contents">
<p>
<code class="filename">build.gradle</code>
</p>
<pre class="programlisting">test {
    useTestNG {
        excludeGroups <span xmlns:xslthl="http://xslthl.sf.net" class="hl-string">'integrationTests'</span>
        includeGroups <span xmlns:xslthl="http://xslthl.sf.net" class="hl-string">'unitTests'</span>
    }
}</pre>
</div>
</div>
<br class="example-break"></div>
<div class="section">
<div class="titlepage">
<div>
<div><h3 class="title">
                <a name="test_reporting"></a>23.12.7. 测试报告</h3>
<h5 class="title">
<a name="test_reporting"></a>
23.12.7.&nbsp;Test reporting
</h5>
</div>
</div>
</div>
<p><code class="literal">test</code>任务默认情况下会生成以下结果。<br/>
The
<code class="literal">Test</code>
task generates the following results by default.
</p>
<div class="itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p>一个 HTML 测试报告。<br/>An HTML test report.</p>
</li>
<li class="listitem">
<p>与Ant Junit report 任务兼容的 XML
                格式的结果。这种格式可以被许多工具所支持，比如CI服务器。<br/>
The results in an XML format that is compatible with the Ant JUnit report task. This format is supported by many
                    other tools, such as CI servers.
</p>
</li>
<li class="listitem">
<p>有效二进制格式的结果。这个任务会从这些二进制结果生成其他的结果。<br/>
Results in an efficient binary format. The task generates the other results from these binary results.
</p>
</li>
</ul>
</div>
<p>您可以使用
          <a class="ulink" href="http://gradledoc.qiniudn.com/1.12/javadoc/org/gradle/api/tasks/testing/Test.html#setTestReport(boolean)" target="_top">
            <code class="classname">Test.setTestReport()</code>
          </a>方法来禁用 HTML 测试报告。目前不能禁用其他的结果。<br/>
You can disable the HTML test report using the
<a class="ulink" href="http://gradledoc.qiniudn.com/1.12/javadoc/org/gradle/api/tasks/testing/Test.html#setTestReport(boolean)" target="_top">
<code class="classname">Test.setTestReport()</code>
</a>
method. The other
                results currently cannot be disabled.
</p>
<p>这里还有一个独立的
          <a class="ulink" href="http://gradledoc.qiniudn.com/1.12/dsl/org.gradle.api.tasks.testing.TestReport.html" target="_top">
            <code class="classname">TestReport</code>
          </a>任务类型，它可以从一个或多个
          <code class="classname">Test</code>任务实例生成的二进制结果中生成 HTML
          测试报告。要使用这个任务类型，你需要定义一个
          <code class="literal">destinationDir</code>和要包含到报告的测试结果。这里是一个范例，从子项目的单元测试中生成一个联合报告：<br/>
There is also a stand-alone
<a class="ulink" href="http://gradledoc.qiniudn.com/1.12/dsl/org.gradle.api.tasks.testing.TestReport.html" target="_top">
<code class="classname">TestReport</code>
</a>
task type which can generate the HTML test
                report from the binary results generated by one or more
<code class="classname">Test</code>
task instances. To use this task type, you need
                to define a
<code class="literal">destinationDir</code>
and the test results to include in the report. Here is a sample which generates a
                combined report for the unit tests from subprojects:
</p>
<div class="example">
<a name="subProjectsTestReport"></a>
<p class="title"><b>示例 23.14. 为多个子项目创建一个单元测试报告</b><br/>
<b>
Example&nbsp;23.14.&nbsp;Creating a unit test report for subprojects
</b>
</p>
<div class="example-contents">
<p>
<code class="filename">build.gradle</code>
</p>
<pre class="programlisting">subprojects {
    apply plugin: <span xmlns:xslthl="http://xslthl.sf.net" class="hl-string">'java'</span>

    <span xmlns:xslthl="http://xslthl.sf.net" class="hl-comment">// Disable the test report for the individual test task</span>
    test {
        reports.html.enabled = false
    }
}

task testReport(type: TestReport) {
    destinationDir = file(<span xmlns:xslthl="http://xslthl.sf.net" class="hl-string">"$buildDir/reports/allTests"</span>)
    <span xmlns:xslthl="http://xslthl.sf.net" class="hl-comment">// Include the results from the `test` task in all subprojects</span>
    reportOn subprojects*.test
}</pre>
</div>
</div>
<br class="example-break">
<p>你应该注意到，
          <code class="literal">TestReport</code>类型组合了多个测试任务的结果，并且需要聚合各个测试类的结果。这意味着，如果一个给定的测试类被多个test任务所执行，那么测试报告将包括那个类的所有执行结果，但它难以区分那个类的每次执行和它们的输出。<br/>
You should note that the
<code class="literal">TestReport</code>
type combines the results from multiple test
                tasks and needs to aggregate the results of individual test classes. This means that if a given test class is executed by
                multiple test tasks, then the test report will include executions of that class, but it can be hard to distinguish individual
                executions of that class and their output.
</p>
<div class="section">
<div class="titlepage">
<div>
<div><h4 class="title">
                  <a name="testNgParameterizedReporting"></a>23.12.7.1. TestNG 参数化方法和报告</h4>
<h6 class="title">
<a name="testNgParameterizedReporting"></a>
23.12.7.1.&nbsp;TestNG parameterized methods and reporting
</h6>
</div>
</div>
</div>
<p>TestNG 支持
            <a class="ulink" href="http://testng.org/doc/documentation-main.html#parameters"
            target="_top">参数化测试方法</a>，允许一个特定的测试方法使用不同的输入执行多次。Gradle
            会在这个方法的执行报告中包含进它的参数值。<br/>
TestNG supports
<a class="ulink" href="http://testng.org/doc/documentation-main.html#parameters" target="_top">parameterizing test methods</a>
,
                    allowing a particular test method to be executed multiple times with different inputs. Gradle includes the parameter values
                    in its reporting of the test method execution.
</p>
<p>给定一个带有两个参数，名为
            <code class="literal">aParameterizedTestMethod</code>参数化测试方法，它将使用名称这个名称进行报告
            ：
            <code class="literal">aParameterizedTestMethod(toStringValueOfParam1,
            toStringValueOfParam2)</code>。这使得在特定的迭代过程，很容易确定参数值。<br/>
Given a parameterized test method named
<code class="literal">aParameterizedTestMethod</code>
that takes two parameters, it will be reported with the name:
<code class="literal">aParameterizedTestMethod(toStringValueOfParam1, toStringValueOfParam2)</code>
. This makes identifying the parameter values for a
                    particular iteration easy.
</p>
</div>
</div>
<div class="section">
<div class="titlepage">
<div>
<div><h3 class="title">
                <a name="N12916"></a>23.12.8. 常规值</h3>
<h5 class="title">
<a name="N12916"></a>
23.12.8.&nbsp;Convention values
</h5>
</div>
</div>
</div>
<div xmlns:xslthl="http://xslthl.sf.net" class="table">
<p class="title"> <b>表 23.14. Java 插件 - test属性</b><br/>
<b>Table&nbsp;23.14.&nbsp;Java plugin - test properties</b>
</p>
<div class="table-contents">
<table id="N12919">
<thead>
<tr>
<td>任务属性<br/>Task Property</td>
<td>类型<br/>Type</td>
<td>默认值<br/>Default Value</td>
</tr>
</thead>
<tr>
<td>
<code class="literal">testClassesDir</code>
</td>
<td>
<code class="classname">File</code>
</td>
<td>
<code class="literal">sourceSets.test.output.classesDir</code>
</td>
</tr>
<tr>
<td>
<code class="literal">classpath</code>
</td>
<td>
<a class="ulink" href="http://gradledoc.qiniudn.com/1.12/javadoc/org/gradle/api/file/FileCollection.html" target="_top">
<code class="classname">FileCollection</code>
</a>
</td>
<td>
<code class="literal">sourceSets.test.runtimeClasspath</code>
</td>
</tr>
<tr>
<td>
<code class="literal">testResultsDir</code>
</td>
<td>
<code class="classname">File</code>
</td>
<td>
<code class="literal">testResultsDir</code>
</td>
</tr>
<tr>
<td>
<code class="literal">testReportDir</code>
</td>
<td>
<code class="classname">File</code>
</td>
<td>
<code class="literal">testReportDir</code>
</td>
</tr>
<tr>
<td>
<code class="literal">testSrcDirs</code>
</td>
<td>
<code class="classname">List&lt;File&gt;</code>
</td>
<td>
<code class="literal">sourceSets.test.java.srcDirs</code>
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="section">
<div class="titlepage">
<div>
<div><h2 class="title">
              <a name="N12970"></a>23.13. Jar</h2>
<h4 class="title">
<a name="N12970"></a>
23.13.&nbsp;Jar
</h4>
</div>
</div>
</div>
<p><code class="literal">Jar</code>任务创建一个包含类文件和项目资源的 JAR 文件。JAR 文件在
        <code class="literal">archives</code>依赖配置中被声明为一个构件。这意味着这个JAR文件被包含在一个依赖它的项目的类路径中。如果你把你的项目上传到仓库，这个JAR
        文件会被声明为依赖描述符的一部分。你可以在
        <a class="xref" href="working_with_files.html#sec:archives">第16.8节，“创建档案”</a>和
        <a class="xref" href="artifact_management.html">第51章， 
        <i>发布artifact</i></a>中了解如何使用archives和配置artifact。<br/>
The
<code class="literal">jar</code>
task creates a JAR file containing the class files and resources of the
            project. The JAR file is declared as an artifact in the
<code class="literal">archives</code>
dependency
            configuration. This means that the JAR is available in the classpath of a dependent project. If you upload
            your project into a repository, this JAR is declared as part of the dependency descriptor. You can learn
            more about how to work with archives in
<a class="xref" href="working_with_files.html#sec:archives">Section&nbsp;16.8, &ldquo;Creating archives&rdquo;</a>
and artifact configurations in
<a class="xref" href="artifact_management.html">
Chapter&nbsp;51, <i>Publishing artifacts</i>
</a>
.
</p>
<div class="section">
<div class="titlepage">
<div>
<div><h3 class="title">
                <a name="sub:manifest"></a>23.13.1. Manifest</h3>
<h5 class="title">
<a name="sub:manifest"></a>
23.13.1.&nbsp;Manifest
</h5>
</div>
</div>
</div>
<p>每个 jar 或war 对象都有一个单独的
          <a class="ulink" href="http://gradledoc.qiniudn.com/1.12/javadoc/org/gradle/api/java/archives/Manifest.html" target="_top">
            <code class="classname">Manifest</code>
          </a>实例的
          <code class="literal">manifest</code>属性。当生成archive时，相应的
          <code class="literal">MANIFEST.MF</code>文件也会被写入进去。<br/>
Each jar or war object has a
<code class="literal">manifest</code>
property with a separate instance of
<a class="ulink" href="http://gradledoc.qiniudn.com/1.12/javadoc/org/gradle/api/java/archives/Manifest.html" target="_top">
<code class="classname">Manifest</code>
</a>
.
                When the archive is generated, a corresponding
<code class="literal">MANIFEST.MF</code>
file is written into the
                archive.
</p>
<div class="example">
<a name="manifest"></a>
<p class="title"><b>示例 23.15. 自定义的MANIFEST.MF</b><br/>
<b>Example&nbsp;23.15.&nbsp;Customization of MANIFEST.MF</b>
</p>
<div class="example-contents">
<p>
<code class="filename">build.gradle</code>
</p>
<pre class="programlisting">jar {
    manifest {
        attributes(<span xmlns:xslthl="http://xslthl.sf.net" class="hl-string">"Implementation-Title"</span>: <span xmlns:xslthl="http://xslthl.sf.net" class="hl-string">"Gradle"</span>, <span xmlns:xslthl="http://xslthl.sf.net" class="hl-string">"Implementation-Version"</span>: version)
    }
}</pre>
</div>
</div>
<br class="example-break">
<p>您可以创建一个单独的
          <code class="classname">Manifest</code>实例。它可以用于共享两个jar包的manifest 信息。<br/>
You can create stand alone instances of a
<code class="classname">Manifest</code>
. You can use that for example,
                to share manifest information between jars.
</p>
<div class="example">
<a name="manifest"></a>
<p class="title"><b>示例 23.16. 创建一个manifest 对象。</b><br/>
<b>Example&nbsp;23.16.&nbsp;Creating a manifest object.</b>
</p>
<div class="example-contents">
<p>
<code class="filename">build.gradle</code>
</p>
<pre class="programlisting">ext.sharedManifest = manifest {
    attributes(<span xmlns:xslthl="http://xslthl.sf.net" class="hl-string">"Implementation-Title"</span>: <span xmlns:xslthl="http://xslthl.sf.net" class="hl-string">"Gradle"</span>, <span xmlns:xslthl="http://xslthl.sf.net" class="hl-string">"Implementation-Version"</span>: version)
}
task fooJar(type: Jar) {
    manifest = project.manifest {
        from sharedManifest
    }
}</pre>
</div>
</div>
<br class="example-break">
<p>你可以把其他的manifest 合并到任何一个
          <code class="classname">Manifest</code>对象中。其他的manifest可能使用文件路径来描述，像上面的例子，使用对另一个
          <code class="classname">Manifest</code>对象的引用。<br/>
You can merge other manifests into any
<code class="classname">Manifest</code>
object. The other manifests might
                be either described by a file path or, like in the example above, by a reference to another
<code class="classname">Manifest</code>
object.
</p>
<div class="example">
<a name="manifest"></a>
<p class="title"><b>示例 23.17. 指定archive的单独MANIFEST.MF</b><br/>
<b>
Example&nbsp;23.17.&nbsp;Separate MANIFEST.MF for a particular archive
</b>
</p>
<div class="example-contents">
<p>
<code class="filename">build.gradle</code>
</p>
<pre class="programlisting">task barJar(type: Jar) {
    manifest {
        attributes key1: <span xmlns:xslthl="http://xslthl.sf.net" class="hl-string">'value1'</span>
        from sharedManifest, <span xmlns:xslthl="http://xslthl.sf.net" class="hl-string">'src/config/basemanifest.txt'</span>
        from(<span xmlns:xslthl="http://xslthl.sf.net" class="hl-string">'src/config/javabasemanifest.txt'</span>, <span xmlns:xslthl="http://xslthl.sf.net" class="hl-string">'src/config/libbasemanifest.txt'</span>) {
            eachEntry { details -&gt;
                <span xmlns:xslthl="http://xslthl.sf.net" class="hl-keyword">if</span> (details.baseValue != details.mergeValue) {
                    details.value = baseValue
                }
                <span xmlns:xslthl="http://xslthl.sf.net" class="hl-keyword">if</span> (details.key == <span xmlns:xslthl="http://xslthl.sf.net" class="hl-string">'foo'</span>) {
                    details.exclude()
                }
            }
        }
    }
}</pre>
</div>
</div>
<br class="example-break">
<p>Manifest会根据在
          <code class="literal">from</code>语句中所声明的顺序进行合并。如果基本的manifest和要合并的manifest都定义了同一个key的值，那么默认情况下会采用要合并的manifest的值。你可以通过添加
          <code class="literal">eachEntry</code> action
          来完全自定义合并行为，它可以让你对每一项生成的manifest 访问它的一个
          <a class="ulink" href="http://gradledoc.qiniudn.com/1.12/javadoc/org/gradle/api/java/archives/ManifestMergeDetails.html" target="_top">
            <code class="classname">ManifestMergeDetails</code>
          </a>实例。这个合并操作不会在from语句中就马上被触发。它是懒执行的，不管是对于生成一个jar包，还是调用了
          
          <code class="literal">writeTo</code> 或者 
          <code class="literal">effectiveManifest</code><br/>
Manifest are merged in the order they are declared by the
<code class="literal">from</code>
statement. If
            the based manifest and the merged manifest both define values for the same key, the merged manifest wins by default.
            You can fully customize the merge behavior by adding
<code class="literal">eachEntry</code>
actions in which
                you have access to a
<a class="ulink" href="http://gradledoc.qiniudn.com/1.12/javadoc/org/gradle/api/java/archives/ManifestMergeDetails.html" target="_top">
<code class="classname">ManifestMergeDetails</code>
</a>
instance for each entry
                of the resulting manifest. The merge is not immediately triggered by the from statement. It is done lazily,
                either when generating the jar, or by calling
<code class="literal">writeTo</code>
or
<code class="literal">effectiveManifest</code>
</p>
<p>你可以很轻松地把一个manifest写入磁盘中。<br/>You can easily write a manifest to disk.</p>
<div class="example">
<a name="manifest"></a>
<p class="title"><b>示例 23.18. 指定archive的单独 MANIFEST.MF</b><br/>
<b>
Example&nbsp;23.18.&nbsp;Separate MANIFEST.MF for a particular archive
</b>
</p>
<div class="example-contents">
<p>
<code class="filename">build.gradle</code>
</p>
<pre class="programlisting">jar.manifest.writeTo(<span xmlns:xslthl="http://xslthl.sf.net" class="hl-string">"$buildDir/mymanifest.mf"</span>)</pre>
</div>
</div>
<br class="example-break"></div>
</div>
<div class="section">
<div class="titlepage">
<div>
<div><h2 class="title">
              <a name="sec:upload"></a>23.14. 上传</h2>
<h4 class="title">
<a name="sec:upload"></a>
23.14.&nbsp;Uploading
</h4>
</div>
</div>
</div>
<p>关于如何上传archives，将在
        <a class="xref" href="artifact_management.html">第51章，
        <i>发布artifacts</i></a>中进行描述。<br/>
How to upload your archives is described in
<a class="xref" href="artifact_management.html">
Chapter&nbsp;51, <i>Publishing artifacts</i>
</a>
.
</p>
</div>
<div class="footnotes">
<br>
<hr align="left" width="100">
<div class="footnote">
<p><sup>[
          <a href="java_plugin.html#N128A7" name="ftn.N128A7" class="para">9</a>]</sup> JUnit wiki 包含了有关如何使用 JUnit
          类别的详细说明： 
          <a class="ulink" href="https://github.com/junit-team/junit/wiki/Categories"
          target="_top">https://github.com/junit-team/junit/wiki/Categories</a>。<br/>
<sup>
[
<a href="java_plugin.html#N128A7" name="ftn.N128A7" class="para">9</a>
]
</sup>
The JUnit wiki contains a detailed description on how to work with JUnit categories:
<a class="ulink" href="https://github.com/junit-team/junit/wiki/Categories" target="_top">https://github.com/junit-team/junit/wiki/Categories</a>
.
</p>
</div>
<div class="footnote">
<p><sup>[
          <a href="java_plugin.html#N128BD" name="ftn.N128BD" class="para">10</a>]</sup> TestNG
          文档包含了有关测试组的更多详细信息： 
          <a class="ulink" href="http://testng.org/doc/documentation-main.html#test-groups"
          target="_top">http://testng.org/doc/documentation-main.html#test-groups</a>。<br/>
<sup>
[
<a href="java_plugin.html#N128BD" name="ftn.N128BD" class="para">10</a>
]
</sup>
The TestNG documentation contains more details about test groups:
<a class="ulink" href="http://testng.org/doc/documentation-main.html#test-groups" target="_top">http://testng.org/doc/documentation-main.html#test-groups</a>
.
</p>
</div>
</div>
</div>
<div class="navfooter">
<div>
<div class="navbar">
<a xmlns:xslthl="http://xslthl.sf.net" href="standard_plugins.html" title="第二十二章. 标准的 Gradle 插件">上一章</a>
<span>|</span>
<a xmlns:xslthl="http://xslthl.sf.net" href="userguide.html" title="Gradle 用户指南">目录</a>
<span>|</span>
<a xmlns:xslthl="http://xslthl.sf.net" href="groovy_plugin.html" title="第二十四章. Groovy 插件">下一章</a>
</div>
</div>
</div>
</body>
</html>